# Electron Hello - å›¾ä¹¦ç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªåŸºäº Electron çš„è·¨å¹³å°æ¡Œé¢å›¾ä¹¦ç®¡ç†åº”ç”¨ï¼Œç”¨äºå­¦ä¹  Electron å¼€å‘æŠ€æœ¯æ ˆã€‚
![main_page](images/main_page.png)

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [æ„å»ºç¯å¢ƒ](#æ„å»ºç¯å¢ƒ)
- [é¡¹ç›®æ¶æ„](#é¡¹ç›®æ¶æ„)
- [é¡¹ç›®ç›®å½•](#é¡¹ç›®ç›®å½•)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
- [æ„å»ºæ‰“åŒ…](#æ„å»ºæ‰“åŒ…)
- [æŠ€æœ¯è¯¦è§£](#æŠ€æœ¯è¯¦è§£)

---

## ğŸ“– é¡¹ç›®ç®€ä»‹

Electron Hello æ˜¯ä¸€ä¸ªåŸºäº Electron æ¡†æ¶å¼€å‘çš„æ¡Œé¢å›¾ä¹¦ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨ä¸ RunStudio é¡¹ç›®ç›¸åŒçš„æŠ€æœ¯æ ˆå’Œæ¶æ„è®¾è®¡ã€‚æœ¬é¡¹ç›®æ—¨åœ¨å¸®åŠ©å¼€å‘è€…å­¦ä¹  Electron åº”ç”¨å¼€å‘ï¼Œç†è§£ä¸»è¿›ç¨‹ã€æ¸²æŸ“è¿›ç¨‹ã€IPC é€šä¿¡ç­‰æ ¸å¿ƒæ¦‚å¿µã€‚

### æ ¸å¿ƒåŠŸèƒ½

- ğŸ“š **å›¾ä¹¦ç®¡ç†**ï¼šå®Œæ•´çš„å¢åˆ æ”¹æŸ¥åŠŸèƒ½
- ğŸ” **æœç´¢ç­›é€‰**ï¼šæ”¯æŒä¹¦åã€ä½œè€…ã€ISBN æœç´¢ï¼Œåˆ†ç±»ã€ä»·æ ¼ç­›é€‰
- ğŸ“Š **æ•°æ®å±•ç¤º**ï¼šè¡¨æ ¼å±•ç¤ºï¼Œæ”¯æŒæ’åº
- ğŸ’¾ **æ•°æ®æŒä¹…åŒ–**ï¼šIndexedDB + localStorage + æ–‡ä»¶ç³»ç»Ÿ
- ğŸ¨ **ä¸»é¢˜åˆ‡æ¢**ï¼šæ”¯æŒæ˜æš—ä¸»é¢˜
- ğŸ’¼ **æ•°æ®å¤‡ä»½**ï¼šæ”¯æŒæ•°æ®å¤‡ä»½å’Œæ¢å¤

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### å›¾ä¹¦ç®¡ç†

- âœ… æ–°å¢å›¾ä¹¦
- âœ… ç¼–è¾‘å›¾ä¹¦
- âœ… åˆ é™¤å›¾ä¹¦
- âœ… æŸ¥çœ‹å›¾ä¹¦åˆ—è¡¨

### æœç´¢ä¸ç­›é€‰

- âœ… æŒ‰ä¹¦åã€ä½œè€…ã€ISBN æœç´¢
- âœ… æŒ‰åˆ†ç±»ç­›é€‰
- âœ… æŒ‰ä»·æ ¼èŒƒå›´ç­›é€‰
- âœ… æŒ‰åˆ›å»ºæ—¶é—´ã€ä»·æ ¼ã€ä¹¦åæ’åº

### æ•°æ®å­˜å‚¨

- âœ… IndexedDBï¼ˆDexieï¼‰- å›¾ä¹¦æ•°æ®
- âœ… localStorageï¼ˆRedux Persistï¼‰- åº”ç”¨çŠ¶æ€
- âœ… æ–‡ä»¶ç³»ç»Ÿ - æ–‡ä»¶å­˜å‚¨
- âœ… electron-store - é…ç½®å­˜å‚¨

### å…¶ä»–åŠŸèƒ½

- âœ… æ˜æš—ä¸»é¢˜åˆ‡æ¢
- âœ… æ•°æ®å¤‡ä»½å’Œæ¢å¤
- âœ… å“åº”å¼å¸ƒå±€

---

## ğŸ›  æŠ€æœ¯æ ˆ

### å‰ç«¯æŠ€æœ¯æ ˆ

#### æ ¸å¿ƒæ¡†æ¶

- **React 18.2.0**ï¼šç°ä»£åŒ–çš„ UI æ¡†æ¶
- **TypeScript 5.6.2**ï¼šç±»å‹å®‰å…¨çš„ JavaScript è¶…é›†
- **React Router 6**ï¼šå®¢æˆ·ç«¯è·¯ç”±ç®¡ç†

#### UI ç»„ä»¶åº“

- **Ant Design 5.22.5**ï¼šä¼ä¸šçº§ UI ç»„ä»¶åº“
- **Styled Components 6.1.11**ï¼šCSS-in-JS æ ·å¼è§£å†³æ–¹æ¡ˆ

#### çŠ¶æ€ç®¡ç†

- **Redux Toolkit 2.2.5**ï¼šç°ä»£åŒ–çš„ Redux çŠ¶æ€ç®¡ç†
- **Redux Persist 6.0.0**ï¼šRedux çŠ¶æ€æŒä¹…åŒ–
- **React Redux 9.1.2**ï¼šReact ä¸ Redux çš„ç»‘å®š

#### æ•°æ®å­˜å‚¨

- **Dexie 4.0.8**ï¼šIndexedDB çš„å°è£…åº“
- **electron-store 8.2.0**ï¼šé…ç½®å­˜å‚¨

### æ¡Œé¢åº”ç”¨æŠ€æœ¯æ ˆ

#### Electron æ ¸å¿ƒ

- **Electron 31.7.6**ï¼šè·¨å¹³å°æ¡Œé¢åº”ç”¨æ¡†æ¶
- **electron-vite 2.3.0**ï¼šåŸºäº Vite çš„ Electron æ„å»ºå·¥å…·
- **electron-builder 24.13.2**ï¼šElectron åº”ç”¨æ‰“åŒ…å·¥å…·

#### Electron å·¥å…·åº“

- **@electron-toolkit/utils 3.0.0**ï¼šElectron å·¥å…·å‡½æ•°
- **@electron-toolkit/preload 3.0.0**ï¼šPreload è„šæœ¬å·¥å…·
- **electron-log 5.1.5**ï¼šæ—¥å¿—è®°å½•
- **electron-window-state 5.0.3**ï¼šçª—å£çŠ¶æ€ç®¡ç†

### æ„å»ºå·¥å…·

- **Vite 5.0.12**ï¼šä¸‹ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·
- **TypeScript**ï¼šç±»å‹æ£€æŸ¥å’Œç¼–è¯‘
- **ESLint**ï¼šä»£ç æ£€æŸ¥
- **Prettier**ï¼šä»£ç æ ¼å¼åŒ–

### åŒ…ç®¡ç†

- **Yarn 4.6.0**ï¼šåŒ…ç®¡ç†å™¨ï¼ˆä½¿ç”¨ Yarn Berryï¼‰

---

## ğŸ”§ æ„å»ºç¯å¢ƒ

### ç³»ç»Ÿè¦æ±‚

- **Node.js**ï¼š>= 18.0.0
- **Yarn**ï¼š>= 4.6.0
- **æ“ä½œç³»ç»Ÿ**ï¼šWindows 10+ / macOS 10.15+ / Linux

### ç¯å¢ƒæ­å»º

#### 1. å®‰è£… Node.js

è®¿é—® [Node.js å®˜ç½‘](https://nodejs.org/) ä¸‹è½½å¹¶å®‰è£… Node.jsï¼ˆæ¨è LTS ç‰ˆæœ¬ï¼‰ã€‚

éªŒè¯å®‰è£…ï¼š

```bash
node --version
npm --version
```

#### 2. å®‰è£… Yarn

é¡¹ç›®ä½¿ç”¨ Yarn Berry 4.6.0ï¼Œéœ€è¦ Yarn äºŒè¿›åˆ¶æ–‡ä»¶ã€‚


```bash
# ä½¿ç”¨ npm å®‰è£… Yarn
npm install -g yarn

# éªŒè¯å®‰è£…
yarn --version
```

#### 3. å…‹éš†é¡¹ç›®

```bash
git clone <repository-url>
cd electron-hello
```

#### 4. å®‰è£…ä¾èµ–

```bash
yarn install
```

#### 5. å¼€å‘ç¯å¢ƒè¿è¡Œ

```bash
yarn dev
```

---

## ğŸ— é¡¹ç›®æ¶æ„

### Electron ä¸‰å±‚æ¶æ„

æœ¬é¡¹ç›®é‡‡ç”¨ç»å…¸çš„ Electron ä¸‰å±‚æ¶æ„ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Renderer Process                â”‚
â”‚  (React + Redux + Ant Design)          â”‚
â”‚  - UI æ¸²æŸ“                               â”‚
â”‚  - ç”¨æˆ·äº¤äº’                               â”‚
â”‚  - çŠ¶æ€ç®¡ç†                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ IPC
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Preload Script                   â”‚
â”‚  (Context Bridge + API Expose)          â”‚
â”‚  - å®‰å…¨ API æš´éœ²                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ Electron IPC
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Main Process                     â”‚
â”‚  (Node.js + Electron APIs)               â”‚
â”‚  - çª—å£ç®¡ç†                               â”‚
â”‚  - æ–‡ä»¶ç³»ç»Ÿæ“ä½œ                           â”‚
â”‚  - ç³»ç»Ÿé›†æˆ                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµæ¶æ„

```
ç”¨æˆ·æ“ä½œ
    â†“
React ç»„ä»¶
    â†“
Redux Action
    â†“
Redux Store
    â†“
IndexedDB (æŒä¹…åŒ–)
    â†“
åº”ç”¨é‡å¯åæ¢å¤
```

### å­˜å‚¨æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ•°æ®åˆ†ç±»å­˜å‚¨ç­–ç•¥                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å›¾ä¹¦æ•°æ®     â†’ IndexedDB (å¤§å®¹é‡)       â”‚
â”‚ åº”ç”¨çŠ¶æ€     â†’ localStorage (å¿«é€Ÿ)      â”‚
â”‚ æ–‡ä»¶æ•°æ®     â†’ æ–‡ä»¶ç³»ç»Ÿ (åŸå§‹æ–‡ä»¶)       â”‚
â”‚ ç³»ç»Ÿé…ç½®     â†’ electron-store (ç»“æ„åŒ–)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### src ç›®å½•ä¸‹çš„ä¸‰ä¸ªæ ¸å¿ƒæ¨¡å—ï¼ˆJava å¼€å‘è€…è§†è§’ï¼‰

å¦‚æœä½ æ˜¯ Java å¼€å‘è€…ï¼Œç†è§£ Electron çš„ä¸‰ä¸ªæ¨¡å—ä¼šæ›´å®¹æ˜“ã€‚è®©æˆ‘ç”¨ Java çš„ç±»æ¯”æ¥è§£é‡Šï¼š

#### 1. `src/main/` - ä¸»è¿›ç¨‹ï¼ˆMain Processï¼‰

**Java ç±»æ¯”ï¼š`public static void main(String[] args)` + ç³»ç»ŸæœåŠ¡å±‚**

**ä½œç”¨**ï¼š
- è¿™æ˜¯æ•´ä¸ªåº”ç”¨çš„**å…¥å£ç‚¹**ï¼Œç±»ä¼¼ Java çš„ `main` æ–¹æ³•
- è´Ÿè´£**ç³»ç»Ÿçº§æ“ä½œ**ï¼Œç±»ä¼¼ Java çš„ Service å±‚ï¼Œå¯ä»¥è®¿é—®æ“ä½œç³»ç»Ÿèµ„æº
- **åªæœ‰ä¸€ä¸ªä¸»è¿›ç¨‹**ï¼Œç±»ä¼¼ Java åº”ç”¨åªæœ‰ä¸€ä¸ªä¸»çº¿ç¨‹å¯åŠ¨

**Java ç±»æ¯”ç¤ºä¾‹**ï¼š

```java
// Java çš„ main æ–¹æ³•
public class Application {
    public static void main(String[] args) {
        // å¯åŠ¨åº”ç”¨
        ApplicationContext context = new ApplicationContext();
        WindowManager windowManager = new WindowManager();
        windowManager.createMainWindow();
    }
}
```

```typescript
// Electron çš„ main/index.tsï¼ˆç±»ä¼¼ä¸Šé¢çš„ Java ä»£ç ï¼‰
app.whenReady().then(() => {
  // å¯åŠ¨åº”ç”¨
  const mainWindow = windowService.createMainWindow()
  registerIpc(mainWindow, app)
})
```

**ä¸»è¦èŒè´£**ï¼š

1. **çª—å£ç®¡ç†**ï¼ˆ`services/WindowService.ts`ï¼‰
   - åˆ›å»ºã€å…³é—­ã€æœ€å°åŒ–çª—å£
   - ç±»ä¼¼ Java Swing çš„ `JFrame` ç®¡ç†

2. **IPC é€šä¿¡å¤„ç†**ï¼ˆ`ipc.ts`ï¼‰
   - å¤„ç†æ¥è‡ªæ¸²æŸ“è¿›ç¨‹çš„è¯·æ±‚
   - ç±»ä¼¼ Java çš„ Controller å±‚ï¼Œæ¥æ”¶å‰ç«¯è¯·æ±‚å¹¶å¤„ç†

3. **ç³»ç»Ÿèµ„æºè®¿é—®**
   - æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼ˆè¯»å–ã€å†™å…¥æ–‡ä»¶ï¼‰
   - ç³»ç»Ÿé…ç½®ï¼ˆä¸»é¢˜ã€è¯­è¨€ç­‰ï¼‰
   - ç±»ä¼¼ Java å¯ä»¥è®¿é—® `File`ã€`Properties` ç­‰ç³»ç»Ÿèµ„æº

4. **åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†**
   - åº”ç”¨å¯åŠ¨ã€é€€å‡º
   - å•å®ä¾‹æ§åˆ¶ï¼ˆé˜²æ­¢é‡å¤å¯åŠ¨ï¼‰
   - ç±»ä¼¼ Java çš„ `ApplicationListener`

**å…³é”®ç‰¹ç‚¹**ï¼š
- âœ… å¯ä»¥è®¿é—® **Node.js API**ï¼ˆæ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œç­‰ï¼‰
- âœ… å¯ä»¥è®¿é—® **Electron API**ï¼ˆçª—å£ã€èœå•ç­‰ï¼‰
- âœ… å¯ä»¥è®¿é—® **æ“ä½œç³»ç»Ÿ API**ï¼ˆç³»ç»Ÿæ‰˜ç›˜ã€é€šçŸ¥ç­‰ï¼‰
- âŒ **ä¸èƒ½ç›´æ¥æ“ä½œ DOM**ï¼ˆä¸èƒ½å†™ HTML/CSSï¼‰
- âŒ **ä¸èƒ½ä½¿ç”¨æµè§ˆå™¨ API**ï¼ˆå¦‚ `localStorage`ã€`fetch` ç­‰ï¼‰

**ç›®å½•ç»“æ„**ï¼š

```
src/main/
â”œâ”€â”€ index.ts              # åº”ç”¨å…¥å£ï¼ˆç±»ä¼¼ Java çš„ main æ–¹æ³•ï¼‰
â”œâ”€â”€ ipc.ts                # IPC å¤„ç†å™¨ï¼ˆç±»ä¼¼ Java çš„ Controllerï¼‰
â”œâ”€â”€ constant.ts           # å¸¸é‡å®šä¹‰
â”œâ”€â”€ services/             # ä¸šåŠ¡æœåŠ¡å±‚ï¼ˆç±»ä¼¼ Java çš„ Service å±‚ï¼‰
â”‚   â”œâ”€â”€ WindowService.ts  # çª—å£ç®¡ç†æœåŠ¡
â”‚   â”œâ”€â”€ ConfigManager.ts # é…ç½®ç®¡ç†æœåŠ¡
â”‚   â””â”€â”€ BackupManager.ts # å¤‡ä»½ç®¡ç†æœåŠ¡
â””â”€â”€ utils/                # å·¥å…·å‡½æ•°ï¼ˆç±»ä¼¼ Java çš„ Util ç±»ï¼‰
    â””â”€â”€ file.ts           # æ–‡ä»¶æ“ä½œå·¥å…·
```

---

#### 2. `src/preload/` - é¢„åŠ è½½è„šæœ¬ï¼ˆPreload Scriptï¼‰

**Java ç±»æ¯”ï¼šæ¥å£ï¼ˆInterfaceï¼‰æˆ–ä»£ç†å±‚ï¼ˆProxyï¼‰**

**ä½œç”¨**ï¼š
- åœ¨ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹ä¹‹é—´å»ºç«‹**å®‰å…¨æ¡¥æ¢**
- ç±»ä¼¼ Java çš„æ¥å£å®šä¹‰ï¼Œè§„å®šäº†æ¸²æŸ“è¿›ç¨‹å¯ä»¥è°ƒç”¨å“ªäº›æ–¹æ³•
- ç±»ä¼¼ Java çš„ä»£ç†æ¨¡å¼ï¼Œéšè—äº†åº•å±‚å®ç°ç»†èŠ‚

**Java ç±»æ¯”ç¤ºä¾‹**ï¼š

```java
// Java æ¥å£å®šä¹‰
public interface SystemAPI {
    String getAppInfo();
    void setTheme(String theme);
    void createBackup(String fileName, String data);
}

// Java å®ç°ç±»ï¼ˆåœ¨ä¸»è¿›ç¨‹ä¸­ï¼‰
public class SystemAPIImpl implements SystemAPI {
    public String getAppInfo() {
        return app.getVersion();
    }
    // ...
}
```

```typescript
// Electron çš„ preload/index.tsï¼ˆç±»ä¼¼ä¸Šé¢çš„æ¥å£å®šä¹‰ï¼‰
const api = {
  getAppInfo: () => ipcRenderer.invoke('app:info'),
  setTheme: (theme: 'light' | 'dark') => ipcRenderer.invoke('app:set-theme', theme),
  backup: {
    create: (fileName: string, data: string) => 
      ipcRenderer.invoke('backup:create', fileName, data)
  }
}

// æš´éœ²ç»™æ¸²æŸ“è¿›ç¨‹ä½¿ç”¨ï¼ˆç±»ä¼¼ Java çš„æ¥å£æš´éœ²ï¼‰
contextBridge.exposeInMainWorld('api', api)
```

**ä¸»è¦èŒè´£**ï¼š

1. **API æš´éœ²**
   - å°†ä¸»è¿›ç¨‹çš„åŠŸèƒ½å®‰å…¨åœ°æš´éœ²ç»™æ¸²æŸ“è¿›ç¨‹
   - ç±»ä¼¼ Java å®šä¹‰æ¥å£ï¼Œè®©å‰ç«¯çŸ¥é“å¯ä»¥è°ƒç”¨å“ªäº›æ–¹æ³•

2. **å®‰å…¨éš”ç¦»**
   - ä½¿ç”¨ `contextBridge` å®‰å…¨åœ°ä¼ é€’æ•°æ®
   - é˜²æ­¢æ¸²æŸ“è¿›ç¨‹ç›´æ¥è®¿é—® Node.js APIï¼ˆå®‰å…¨è€ƒè™‘ï¼‰
   - ç±»ä¼¼ Java çš„è®¿é—®æ§åˆ¶ï¼Œåªæš´éœ²å¿…è¦çš„æ¥å£

3. **ç±»å‹å®šä¹‰**ï¼ˆ`index.d.ts`ï¼‰
   - æä¾› TypeScript ç±»å‹å®šä¹‰
   - ç±»ä¼¼ Java çš„æ¥å£æ–‡æ¡£ï¼Œå‘Šè¯‰å¼€å‘è€…æœ‰å“ªäº›æ–¹æ³•å¯ç”¨

**å·¥ä½œæµç¨‹**ï¼š

```
æ¸²æŸ“è¿›ç¨‹è°ƒç”¨: window.api.getAppInfo()
    â†“
Preload è„šæœ¬: ipcRenderer.invoke('app:info')
    â†“
ä¸»è¿›ç¨‹å¤„ç†: ipcMain.handle('app:info', () => {...})
    â†“
è¿”å›ç»“æœ: é€šè¿‡ IPC è¿”å›ç»™æ¸²æŸ“è¿›ç¨‹
```

**å…³é”®ç‰¹ç‚¹**ï¼š
- âœ… åœ¨**æ¸²æŸ“è¿›ç¨‹åŠ è½½å‰**è¿è¡Œ
- âœ… å¯ä»¥è®¿é—® **Node.js API** å’Œ **Electron API**
- âœ… é€šè¿‡ `contextBridge` å®‰å…¨æš´éœ² API
- âŒ **ä¸èƒ½æ“ä½œ DOM**ï¼ˆä¸èƒ½å†™ HTMLï¼‰
- âŒ **ä¸èƒ½ç›´æ¥è®¿é—®æ¸²æŸ“è¿›ç¨‹çš„å˜é‡**

**ä¸ºä»€ä¹ˆéœ€è¦ Preloadï¼Ÿ**

**å®‰å…¨é—®é¢˜**ï¼šå¦‚æœä¸ä½¿ç”¨ Preloadï¼Œæ¸²æŸ“è¿›ç¨‹ï¼ˆç½‘é¡µï¼‰å¯ä»¥ç›´æ¥è®¿é—® Node.js APIï¼Œè¿™å¾ˆå±é™©ï¼

```typescript
// âŒ å±é™©ï¼šæ¸²æŸ“è¿›ç¨‹ç›´æ¥è®¿é—® Node.jsï¼ˆä¸å®‰å…¨ï¼‰
// å¦‚æœç½‘é¡µè¢«æ¶æ„ä»£ç æ³¨å…¥ï¼Œå¯ä»¥åˆ é™¤ä½ çš„æ–‡ä»¶ï¼
window.require('fs').unlinkSync('é‡è¦æ–‡ä»¶.txt')

// âœ… å®‰å…¨ï¼šé€šè¿‡ Preload æš´éœ²å®‰å…¨çš„ API
window.api.backup.create('backup.json', data) // åªèƒ½è°ƒç”¨æˆ‘ä»¬å®šä¹‰çš„æ–¹æ³•
```

---

#### 3. `src/renderer/` - æ¸²æŸ“è¿›ç¨‹ï¼ˆRenderer Processï¼‰

**Java ç±»æ¯”ï¼šSwing GUI åº”ç”¨çš„å‰ç«¯ç•Œé¢å±‚**

**ä½œç”¨**ï¼š
- è´Ÿè´£**æ˜¾ç¤ºç”¨æˆ·ç•Œé¢**ï¼Œç±»ä¼¼ Java Swing çš„ `JPanel`ã€`JButton` ç­‰ç»„ä»¶
- è¿è¡Œåœ¨**æµè§ˆå™¨ç¯å¢ƒ**ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ‰€æœ‰ Web æŠ€æœ¯ï¼ˆHTMLã€CSSã€JavaScriptï¼‰
- ç±»ä¼¼ Java çš„ View å±‚ï¼Œè´Ÿè´£å±•ç¤ºå’Œç”¨æˆ·äº¤äº’

**Java ç±»æ¯”ç¤ºä¾‹**ï¼š

```java
// Java Swing åº”ç”¨
public class BookStoreFrame extends JFrame {
    private JTable bookTable;
    private JButton addButton;
    
    public BookStoreFrame() {
        // åˆ›å»ºç•Œé¢ç»„ä»¶
        bookTable = new JTable();
        addButton = new JButton("æ·»åŠ å›¾ä¹¦");
        
        // å¸ƒå±€
        add(bookTable, BorderLayout.CENTER);
        add(addButton, BorderLayout.SOUTH);
        
        // äº‹ä»¶å¤„ç†
        addButton.addActionListener(e -> {
            // è°ƒç”¨åç«¯æœåŠ¡
            bookService.addBook(newBook);
        });
    }
}
```

```typescript
// Electron çš„ rendererï¼ˆç±»ä¼¼ä¸Šé¢çš„ Java Swing ä»£ç ï¼‰
function BookStorePage() {
  const [books, setBooks] = useState([])
  
  return (
    <div>
      <Table dataSource={books} />
      <Button onClick={handleAdd}>æ·»åŠ å›¾ä¹¦</Button>
    </div>
  )
  
  const handleAdd = async () => {
    // é€šè¿‡ Preload æš´éœ²çš„ API è°ƒç”¨ä¸»è¿›ç¨‹
    await window.api.backup.create('backup.json', data)
  }
}
```

**ä¸»è¦èŒè´£**ï¼š

1. **UI æ¸²æŸ“**
   - ä½¿ç”¨ React ç»„ä»¶æ„å»ºç•Œé¢
   - ç±»ä¼¼ Java Swing çš„ç»„ä»¶å¸ƒå±€

2. **ç”¨æˆ·äº¤äº’**
   - å¤„ç†ç”¨æˆ·ç‚¹å‡»ã€è¾“å…¥ç­‰æ“ä½œ
   - ç±»ä¼¼ Java çš„äº‹ä»¶ç›‘å¬å™¨ï¼ˆ`ActionListener`ï¼‰

3. **çŠ¶æ€ç®¡ç†**
   - ä½¿ç”¨ Redux ç®¡ç†åº”ç”¨çŠ¶æ€
   - ç±»ä¼¼ Java çš„ Model å±‚ï¼Œå­˜å‚¨ä¸šåŠ¡æ•°æ®

4. **æ•°æ®å±•ç¤º**
   - ä» IndexedDB è¯»å–æ•°æ®å¹¶å±•ç¤º
   - ç±»ä¼¼ Java ä»æ•°æ®åº“è¯»å–æ•°æ®å¹¶æ˜¾ç¤ºåœ¨è¡¨æ ¼ä¸­

**ç›®å½•ç»“æ„**ï¼š

```
src/renderer/
â”œâ”€â”€ index.html            # HTML å…¥å£ï¼ˆç±»ä¼¼ Java çš„çª—å£å®šä¹‰ï¼‰
â””â”€â”€ src/
    â”œâ”€â”€ main.tsx          # React å…¥å£ï¼ˆç±»ä¼¼ Java çš„ main æ–¹æ³•å¯åŠ¨ GUIï¼‰
    â”œâ”€â”€ App.tsx            # æ ¹ç»„ä»¶ï¼ˆç±»ä¼¼ Java çš„ä¸»çª—å£ç±»ï¼‰
    â”œâ”€â”€ pages/             # é¡µé¢ç»„ä»¶ï¼ˆç±»ä¼¼ Java çš„å„ä¸ªçª—å£ç±»ï¼‰
    â”‚   â”œâ”€â”€ BookStorePage.tsx
    â”‚   â””â”€â”€ components/    # å­ç»„ä»¶ï¼ˆç±»ä¼¼ Java çš„è‡ªå®šä¹‰ç»„ä»¶ï¼‰
    â”œâ”€â”€ store/             # Redux çŠ¶æ€ç®¡ç†ï¼ˆç±»ä¼¼ Java çš„ Model å±‚ï¼‰
    â”œâ”€â”€ context/           # React Contextï¼ˆç±»ä¼¼ Java çš„å…¨å±€é…ç½®ï¼‰
    â”œâ”€â”€ databases/         # æ•°æ®åº“å®šä¹‰ï¼ˆç±»ä¼¼ Java çš„ DAO å±‚ï¼‰
    â””â”€â”€ types/             # ç±»å‹å®šä¹‰ï¼ˆç±»ä¼¼ Java çš„å®ä½“ç±»ï¼‰
```

**å…³é”®ç‰¹ç‚¹**ï¼š
- âœ… å¯ä»¥ä½¿ç”¨ **æ‰€æœ‰ Web API**ï¼ˆ`localStorage`ã€`fetch`ã€`IndexedDB` ç­‰ï¼‰
- âœ… å¯ä»¥ä½¿ç”¨ **Reactã€Vue ç­‰å‰ç«¯æ¡†æ¶**
- âœ… å¯ä»¥ä½¿ç”¨ **HTMLã€CSSã€JavaScript**
- âœ… å¯ä»¥æ“ä½œ **DOM**
- âŒ **ä¸èƒ½ç›´æ¥è®¿é—® Node.js API**ï¼ˆéœ€è¦é€šè¿‡ Preloadï¼‰
- âŒ **ä¸èƒ½ç›´æ¥è®¿é—®æ–‡ä»¶ç³»ç»Ÿ**ï¼ˆéœ€è¦é€šè¿‡ IPC è°ƒç”¨ä¸»è¿›ç¨‹ï¼‰

---

### ä¸‰ä¸ªæ¨¡å—çš„åä½œå…³ç³»

**å®Œæ•´çš„æ•°æ®æµ**ï¼ˆä»¥"åˆ›å»ºå¤‡ä»½"ä¸ºä¾‹ï¼‰ï¼š

```
1. ç”¨æˆ·åœ¨æ¸²æŸ“è¿›ç¨‹ç‚¹å‡»"å¤‡ä»½"æŒ‰é’®
   â†“
2. React ç»„ä»¶è°ƒç”¨: window.api.backup.create(...)
   â†“
3. Preload è„šæœ¬æ¥æ”¶: ipcRenderer.invoke('backup:create', ...)
   â†“
4. ä¸»è¿›ç¨‹å¤„ç†: ipcMain.handle('backup:create', ...)
   â†“
5. ä¸»è¿›ç¨‹è°ƒç”¨ BackupManager æœåŠ¡ï¼ˆç±»ä¼¼ Java çš„ Service å±‚ï¼‰
   â†“
6. ä¸»è¿›ç¨‹æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œåˆ›å»ºå¤‡ä»½æ–‡ä»¶
   â†“
7. ç»“æœé€šè¿‡ IPC è¿”å›ç»™æ¸²æŸ“è¿›ç¨‹
   â†“
8. React ç»„ä»¶æ˜¾ç¤º"å¤‡ä»½æˆåŠŸ"æç¤º
```

**Java å¯¹æ¯”**ï¼š

```java
// Java ä¸‰å±‚æ¶æ„
Controller (æ¸²æŸ“è¿›ç¨‹) 
    â†’ Service (ä¸»è¿›ç¨‹)
        â†’ DAO (æ–‡ä»¶ç³»ç»Ÿæ“ä½œ)

// Electron ä¸‰å±‚æ¶æ„
Renderer (æ¸²æŸ“è¿›ç¨‹)
    â†’ Preload (æ¥å£å±‚)
        â†’ Main (ä¸»è¿›ç¨‹)
            â†’ Services (ä¸šåŠ¡é€»è¾‘)
                â†’ File System (ç³»ç»Ÿèµ„æº)
```

---

### æ€»ç»“å¯¹æ¯”è¡¨

| æ¨¡å— | Java ç±»æ¯” | è¿è¡Œç¯å¢ƒ | å¯ä»¥åšä»€ä¹ˆ | ä¸èƒ½åšä»€ä¹ˆ |
|------|----------|----------|------------|------------|
| **main** | `main` æ–¹æ³• + Service å±‚ | Node.js ç¯å¢ƒ | è®¿é—®ç³»ç»Ÿèµ„æºã€æ–‡ä»¶æ“ä½œã€çª—å£ç®¡ç† | æ“ä½œ DOMã€ä½¿ç”¨æµè§ˆå™¨ API |
| **preload** | æ¥å£/ä»£ç†å±‚ | Node.js ç¯å¢ƒ | æš´éœ² APIã€å®‰å…¨æ¡¥æ¥ | æ“ä½œ DOMã€ç›´æ¥è®¿é—®æ¸²æŸ“è¿›ç¨‹å˜é‡ |
| **renderer** | Swing GUI ç•Œé¢å±‚ | æµè§ˆå™¨ç¯å¢ƒ | HTML/CSS/JSã€Reactã€Web API | ç›´æ¥è®¿é—® Node.js APIã€æ–‡ä»¶ç³»ç»Ÿ |

**è®°å¿†å£è¯€**ï¼š
- **main** = åå°æœåŠ¡ï¼ˆJava çš„ Service å±‚ï¼‰
- **preload** = æ¥å£å®šä¹‰ï¼ˆJava çš„ Interfaceï¼‰
- **renderer** = å‰ç«¯ç•Œé¢ï¼ˆJava çš„ Swing GUIï¼‰

---

## ğŸ“ é¡¹ç›®ç›®å½•

```
electron-hello/
â”œâ”€â”€ build/                      # æ„å»ºèµ„æº
â”‚   â”œâ”€â”€ icon.ico               # Windows å›¾æ ‡
â”‚   â””â”€â”€ icon.png               # Linux/macOS å›¾æ ‡
â”‚
â”œâ”€â”€ src/                        # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ main/                  # ä¸»è¿›ç¨‹ä»£ç 
â”‚   â”‚   â”œâ”€â”€ index.ts          # ä¸»è¿›ç¨‹å…¥å£
â”‚   â”‚   â”œâ”€â”€ ipc.ts            # IPC å¤„ç†å™¨æ³¨å†Œ
â”‚   â”‚   â”œâ”€â”€ constant.ts       # å¸¸é‡å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ services/         # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ WindowService.ts      # çª—å£ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ ConfigManager.ts      # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ BackupManager.ts      # å¤‡ä»½ç®¡ç†
â”‚   â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚   â”‚       â””â”€â”€ file.ts        # æ–‡ä»¶å·¥å…·
â”‚   â”‚
â”‚   â”œâ”€â”€ preload/              # é¢„åŠ è½½è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ index.ts         # Preload å…¥å£
â”‚   â”‚   â””â”€â”€ index.d.ts       # ç±»å‹å®šä¹‰
â”‚   â”‚
â”‚   â””â”€â”€ renderer/             # æ¸²æŸ“è¿›ç¨‹ä»£ç 
â”‚       â”œâ”€â”€ index.html       # HTML å…¥å£
â”‚       â””â”€â”€ src/
â”‚           â”œâ”€â”€ main.tsx     # React å…¥å£
â”‚           â”œâ”€â”€ App.tsx      # æ ¹ç»„ä»¶
â”‚           â”œâ”€â”€ pages/       # é¡µé¢ç»„ä»¶
â”‚           â”‚   â”œâ”€â”€ BookStorePage.tsx
â”‚           â”‚   â””â”€â”€ components/
â”‚           â”‚       â”œâ”€â”€ BookModal.tsx
â”‚           â”‚       â””â”€â”€ BackupModal.tsx
â”‚           â”œâ”€â”€ store/        # Redux Store
â”‚           â”‚   â”œâ”€â”€ index.ts
â”‚           â”‚   â”œâ”€â”€ books.ts
â”‚           â”‚   â””â”€â”€ settings.ts
â”‚           â”œâ”€â”€ databases/    # æ•°æ®åº“å®šä¹‰
â”‚           â”‚   â””â”€â”€ index.ts
â”‚           â”œâ”€â”€ context/      # React Context
â”‚           â”‚   â”œâ”€â”€ ThemeProvider.tsx
â”‚           â”‚   â””â”€â”€ AntdProvider.tsx
â”‚           â””â”€â”€ types/         # ç±»å‹å®šä¹‰
â”‚               â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ .gitignore                # Git å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ eslint.config.mjs         # ESLint ä»£ç æ£€æŸ¥é…ç½®ï¼ˆESLint 9 flat configï¼‰
â”œâ”€â”€ .prettierrc.yaml         # Prettier ä»£ç æ ¼å¼åŒ–é…ç½®
â”œâ”€â”€ .yarnrc.yml              # Yarn é…ç½®æ–‡ä»¶ï¼ˆYarn Berryï¼‰
â”œâ”€â”€ .yarn/                   # Yarn ç›¸å…³æ–‡ä»¶
â”‚   â””â”€â”€ releases/            # Yarn äºŒè¿›åˆ¶æ–‡ä»¶
â”‚       â””â”€â”€ yarn-4.6.0.cjs   # Yarn 4.6.0 å¯æ‰§è¡Œæ–‡ä»¶
â”œâ”€â”€ yarn.lock                # Yarn ä¾èµ–é”å®šæ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ electron-builder.yml     # Electron Builder é…ç½®
â”œâ”€â”€ electron.vite.config.ts  # Electron Vite é…ç½®
â”œâ”€â”€ package.json             # é¡¹ç›®é…ç½®
â”œâ”€â”€ tsconfig.json            # TypeScript é…ç½®
â”œâ”€â”€ tsconfig.node.json       # Node ç¯å¢ƒ TS é…ç½®
â”œâ”€â”€ tsconfig.web.json        # Web ç¯å¢ƒ TS é…ç½®
â”œâ”€â”€ LICENSE                  # è®¸å¯è¯
â””â”€â”€ README.md                # é¡¹ç›®è¯´æ˜
```

### ç›®å½•è¯´æ˜

#### `src/main/` - ä¸»è¿›ç¨‹

- **index.ts**ï¼šåº”ç”¨å…¥å£ï¼Œåˆå§‹åŒ–çª—å£å’ŒæœåŠ¡
- **ipc.ts**ï¼šIPC å¤„ç†å™¨æ³¨å†Œ
- **services/**ï¼šä¸šåŠ¡æœåŠ¡
  - `WindowService.ts`ï¼šçª—å£ç”Ÿå‘½å‘¨æœŸç®¡ç†
  - `ConfigManager.ts`ï¼šé…ç½®ç®¡ç†ï¼ˆä¸»é¢˜ã€è¯­è¨€ç­‰ï¼‰
  - `BackupManager.ts`ï¼šæ•°æ®å¤‡ä»½å’Œæ¢å¤
- **utils/**ï¼šå·¥å…·å‡½æ•°

#### `src/preload/` - é¢„åŠ è½½è„šæœ¬

- **index.ts**ï¼šé€šè¿‡ `contextBridge` å®‰å…¨æš´éœ² API
- **index.d.ts**ï¼šTypeScript ç±»å‹å®šä¹‰

#### `src/renderer/` - æ¸²æŸ“è¿›ç¨‹

- **pages/**ï¼šé¡µé¢ç»„ä»¶
  - `BookStorePage.tsx`ï¼šå›¾ä¹¦ç®¡ç†ä¸»é¡µé¢
  - `components/`ï¼šé¡µé¢å­ç»„ä»¶
- **store/**ï¼šRedux çŠ¶æ€ç®¡ç†
  - `index.ts`ï¼šStore é…ç½®
  - `books.ts`ï¼šå›¾ä¹¦çŠ¶æ€
  - `settings.ts`ï¼šè®¾ç½®çŠ¶æ€
- **databases/**ï¼šæ•°æ®åº“å®šä¹‰ï¼ˆDexieï¼‰
- **context/**ï¼šReact Context
  - `ThemeProvider.tsx`ï¼šä¸»é¢˜ç®¡ç†
  - `AntdProvider.tsx`ï¼šAnt Design é…ç½®

### é…ç½®æ–‡ä»¶è¯´æ˜

è¿è¡Œ `yarn install` åï¼Œé¡¹ç›®æ ¹ç›®å½•ä¼šè‡ªåŠ¨ç”Ÿæˆæˆ–æ›´æ–°ä»¥ä¸‹é…ç½®æ–‡ä»¶ï¼š

#### `yarn.lock` - Yarn é”å®šæ–‡ä»¶

**ä½œç”¨**ï¼š

- é”å®šæ‰€æœ‰ä¾èµ–åŒ…çš„ç²¾ç¡®ç‰ˆæœ¬å·ï¼Œç¡®ä¿å›¢é˜Ÿæˆå‘˜å’Œ CI/CD ç¯å¢ƒå®‰è£…ç›¸åŒç‰ˆæœ¬çš„ä¾èµ–
- è®°å½•ä¾èµ–åŒ…çš„ä¾èµ–å…³ç³»æ ‘ï¼Œä¿è¯ä¾èµ–è§£æçš„ä¸€è‡´æ€§
- åŒ…å«æ¯ä¸ªåŒ…çš„æ ¡éªŒå’Œï¼ˆchecksumï¼‰ï¼Œç¡®ä¿åŒ…å®Œæ•´æ€§

**ç‰¹ç‚¹**ï¼š

- ç”± Yarn è‡ªåŠ¨ç”Ÿæˆï¼Œ**ä¸è¦æ‰‹åŠ¨ç¼–è¾‘**
- åº”è¯¥æäº¤åˆ° Git ä»“åº“ï¼Œç¡®ä¿å›¢é˜Ÿä½¿ç”¨ç›¸åŒçš„ä¾èµ–ç‰ˆæœ¬
- æ–‡ä»¶è¾ƒå¤§ï¼ˆé€šå¸¸å‡ åƒè¡Œï¼‰ï¼ŒåŒ…å«æ‰€æœ‰ä¾èµ–çš„è¯¦ç»†ä¿¡æ¯

**ç¤ºä¾‹å†…å®¹**ï¼š

```yaml
# This file is generated by running "yarn install" inside your project.
# Manual changes might be lost - proceed with caution!

__metadata:
  version: 8
  cacheKey: 10c0

'react@npm:^18.2.0':
  version: 18.2.0
  resolution: 'react@npm:18.2.0'
  checksum: 10c0/...
  dependencies:
    loose-envify: 'npm:^1.1.0'
```

**ä½•æ—¶æ›´æ–°**ï¼š

- è¿è¡Œ `yarn install` æ—¶ä¼šè‡ªåŠ¨æ›´æ–°
- æ·»åŠ ã€æ›´æ–°æˆ–åˆ é™¤ä¾èµ–æ—¶ä¼šæ›´æ–°
- è¿è¡Œ `yarn upgrade` æ—¶ä¼šæ›´æ–°

#### `.yarnrc.yml` - Yarn é…ç½®æ–‡ä»¶

**ä½œç”¨**ï¼š

- é…ç½® Yarn çš„è¡Œä¸ºå’Œè®¾ç½®
- æŒ‡å®š Yarn ç‰ˆæœ¬å’Œè·¯å¾„
- é…ç½®åŒ…é“¾æ¥æ–¹å¼ã€ç¼“å­˜ä½ç½®ç­‰

**å½“å‰é…ç½®**ï¼š

```yaml
nodeLinker: node-modules # ä½¿ç”¨ä¼ ç»Ÿçš„ node_modules ç›®å½•ç»“æ„
yarnPath: .yarn/releases/yarn-4.6.0.cjs # æŒ‡å®š Yarn äºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„
```

**é…ç½®è¯´æ˜**ï¼š

- `nodeLinker: node-modules`ï¼šä½¿ç”¨ä¼ ç»Ÿçš„ `node_modules` ç›®å½•ï¼ˆè€Œä¸æ˜¯ Yarn PnPï¼‰
- `yarnPath`ï¼šæŒ‡å®šé¡¹ç›®ä½¿ç”¨çš„ Yarn ç‰ˆæœ¬ï¼Œç¡®ä¿å›¢é˜Ÿä½¿ç”¨ç›¸åŒçš„ Yarn ç‰ˆæœ¬

**å…¶ä»–å¸¸ç”¨é…ç½®**ï¼š

```yaml
# è®¾ç½®ç¼“å­˜ç›®å½•
cacheFolder: '.yarn/cache'

# è®¾ç½®è¶…æ—¶æ—¶é—´
httpTimeout: 300000

# å¯ç”¨ä¸å¯å˜å®‰è£…ï¼ˆCI/CD ç¯å¢ƒæ¨èï¼‰
enableImmutableInstalls: true

# é…ç½®é•œåƒæºï¼ˆå¦‚æœéœ€è¦ï¼‰
npmRegistryServer: 'https://registry.npmmirror.com'
```

**æ³¨æ„äº‹é¡¹**ï¼š

- åº”è¯¥æäº¤åˆ° Git ä»“åº“
- ä¿®æ”¹åéœ€è¦é‡æ–°è¿è¡Œ `yarn install`

#### `.prettierrc.yaml` - Prettier ä»£ç æ ¼å¼åŒ–é…ç½®

**ä½œç”¨**ï¼š

- é…ç½® Prettier ä»£ç æ ¼å¼åŒ–å·¥å…·çš„è§„åˆ™
- ç»Ÿä¸€å›¢é˜Ÿä»£ç é£æ ¼ï¼Œè‡ªåŠ¨æ ¼å¼åŒ–ä»£ç 

**å½“å‰é…ç½®**ï¼š

```yaml
semi: false # ä¸ä½¿ç”¨åˆ†å·
singleQuote: true # ä½¿ç”¨å•å¼•å·
printWidth: 100 # æ¯è¡Œæœ€å¤§é•¿åº¦ 100 å­—ç¬¦
trailingComma: 'none' # ä¸ä½¿ç”¨å°¾éšé€—å·
arrowParens: 'avoid' # ç®­å¤´å‡½æ•°å‚æ•°é¿å…æ‹¬å·
```

**é…ç½®è¯´æ˜**ï¼š

- `semi: false`ï¼šJavaScript/TypeScript ä»£ç ä¸ä½¿ç”¨åˆ†å·ç»“å°¾
- `singleQuote: true`ï¼šå­—ç¬¦ä¸²ä½¿ç”¨å•å¼•å·è€Œä¸æ˜¯åŒå¼•å·
- `printWidth: 100`ï¼šä»£ç è¡Œå®½é™åˆ¶ä¸º 100 ä¸ªå­—ç¬¦
- `trailingComma: 'none'`ï¼šå¯¹è±¡å’Œæ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ åä¸åŠ é€—å·
- `arrowParens: 'avoid'`ï¼šå•å‚æ•°ç®­å¤´å‡½æ•°çœç•¥æ‹¬å·ï¼Œå¦‚ `x => x` è€Œä¸æ˜¯ `(x) => x`

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
# æ ¼å¼åŒ–æ‰€æœ‰æ–‡ä»¶
yarn format

# æˆ–åœ¨ç¼–è¾‘å™¨ä¸­é…ç½®è‡ªåŠ¨æ ¼å¼åŒ–
# VS Code: å®‰è£… Prettier æ‰©å±•ï¼Œä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–
```

**å…¶ä»–å¸¸ç”¨é…ç½®é€‰é¡¹**ï¼š

```yaml
tabWidth: 2 # ç¼©è¿›ä½¿ç”¨ 2 ä¸ªç©ºæ ¼
useTabs: false # ä¸ä½¿ç”¨ Tabï¼Œä½¿ç”¨ç©ºæ ¼
bracketSpacing: true # å¯¹è±¡æ‹¬å·å†…åŠ ç©ºæ ¼ { foo: bar }
jsxSingleQuote: false # JSX ä¸­ä½¿ç”¨åŒå¼•å·
endOfLine: 'lf' # ä½¿ç”¨ LF æ¢è¡Œç¬¦ï¼ˆUnix é£æ ¼ï¼‰
```

**æ³¨æ„äº‹é¡¹**ï¼š

- åº”è¯¥æäº¤åˆ° Git ä»“åº“ï¼Œç¡®ä¿å›¢é˜Ÿä½¿ç”¨ç›¸åŒçš„æ ¼å¼åŒ–è§„åˆ™
- ä¸ ESLint é…åˆä½¿ç”¨æ—¶ï¼Œéœ€è¦å®‰è£… `eslint-config-prettier` é¿å…å†²çª

#### `eslint.config.mjs` - ESLint ä»£ç æ£€æŸ¥é…ç½®

**ä½œç”¨**ï¼š

- é…ç½® ESLint ä»£ç æ£€æŸ¥å·¥å…·çš„è§„åˆ™
- å®šä¹‰ä»£ç è§„èŒƒå’Œæ£€æŸ¥è§„åˆ™ï¼Œç¡®ä¿ä»£ç è´¨é‡
- ä½¿ç”¨ ESLint 9 çš„ flat config æ ¼å¼ï¼ˆæ–°çš„é…ç½®æ ¼å¼ï¼‰

**å½“å‰é…ç½®**ï¼š

```javascript
import electronConfigPrettier from '@electron-toolkit/eslint-config-prettier'
import tseslint from '@electron-toolkit/eslint-config-ts'
import eslint from '@eslint/js'

export default [
  eslint.configs.recommended,
  ...tseslint.configs.recommended,
  electronConfigPrettier,
  {
    rules: {
      '@typescript-eslint/no-explicit-any': 'off',
      '@typescript-eslint/no-unused-vars': ['warn', { argsIgnorePattern: '^_' }]
    }
  },
  {
    ignores: ['node_modules/**', 'dist/**', 'out/**', '.yarn/**']
  }
]
```

**é…ç½®è¯´æ˜**ï¼š

- **`eslint.configs.recommended`**ï¼šESLint å®˜æ–¹æ¨èè§„åˆ™é›†
- **`tseslint.configs.recommended`**ï¼šTypeScript ESLint æ¨èè§„åˆ™é›†ï¼ˆæ¥è‡ª `@electron-toolkit/eslint-config-ts`ï¼‰
- **`electronConfigPrettier`**ï¼šPrettier é›†æˆé…ç½®ï¼Œé¿å…ä¸ ESLint è§„åˆ™å†²çª
- **è‡ªå®šä¹‰è§„åˆ™**ï¼š
  - `@typescript-eslint/no-explicit-any: 'off'`ï¼šå…³é—­ç¦æ­¢ä½¿ç”¨ `any` ç±»å‹çš„æ£€æŸ¥
  - `@typescript-eslint/no-unused-vars: ['warn', { argsIgnorePattern: '^_' }]`ï¼šæœªä½¿ç”¨çš„å˜é‡æ˜¾ç¤ºè­¦å‘Šï¼Œä½†ä»¥ä¸‹åˆ’çº¿å¼€å¤´çš„å‚æ•°ä¼šè¢«å¿½ç•¥
- **`ignores`**ï¼šå¿½ç•¥æ£€æŸ¥çš„ç›®å½•å’Œæ–‡ä»¶æ¨¡å¼

**ä¸ºä»€ä¹ˆä½¿ç”¨ flat configï¼Ÿ**

- ESLint 9 é»˜è®¤ä½¿ç”¨æ–°çš„ flat config æ ¼å¼ï¼ˆ`eslint.config.mjs`ï¼‰
- æ—§çš„ `.eslintrc.*` æ ¼å¼åœ¨ ESLint 9 ä¸­å·²ä¸å†æ”¯æŒ
- Flat config æä¾›æ›´çµæ´»çš„é…ç½®æ–¹å¼ï¼Œæ”¯æŒ ES æ¨¡å—å¯¼å…¥

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
# æ£€æŸ¥ä»£ç 
yarn lint

# è‡ªåŠ¨ä¿®å¤å¯ä¿®å¤çš„é—®é¢˜
yarn lint --fix
```

**åœ¨ç¼–è¾‘å™¨ä¸­ä½¿ç”¨**ï¼š

- **VS Code**ï¼šå®‰è£… ESLint æ‰©å±•ï¼Œä¼šè‡ªåŠ¨è¯»å– `eslint.config.mjs` é…ç½®
- ä¿å­˜æ–‡ä»¶æ—¶è‡ªåŠ¨æ£€æŸ¥ä»£ç 
- é”™è¯¯å’Œè­¦å‘Šä¼šæ˜¾ç¤ºåœ¨ç¼–è¾‘å™¨ä¸­

**æ³¨æ„äº‹é¡¹**ï¼š

- åº”è¯¥æäº¤åˆ° Git ä»“åº“ï¼Œç¡®ä¿å›¢é˜Ÿä½¿ç”¨ç›¸åŒçš„ä»£ç è§„èŒƒ
- ä¸ Prettier é…åˆä½¿ç”¨æ—¶ï¼Œéœ€è¦ `@electron-toolkit/eslint-config-prettier` é¿å…è§„åˆ™å†²çª
- å¦‚æœé‡åˆ° "Invalid Options" é”™è¯¯ï¼Œæ£€æŸ¥ ESLint ç‰ˆæœ¬æ˜¯å¦ä¸º 9.xï¼Œå¹¶ç¡®ä¿ä½¿ç”¨ flat config æ ¼å¼

**ä»æ—§é…ç½®è¿ç§»**ï¼š

å¦‚æœé¡¹ç›®ä¹‹å‰ä½¿ç”¨ `.eslintrc.cjs`ï¼Œéœ€è¦è¿ç§»åˆ° `eslint.config.mjs`ï¼š

1. åˆ é™¤ `.eslintrc.cjs` æ–‡ä»¶
2. åˆ›å»º `eslint.config.mjs` æ–‡ä»¶ï¼ˆä½¿ç”¨ä¸Šé¢çš„é…ç½®æ ¼å¼ï¼‰
3. æ›´æ–° `package.json` ä¸­çš„ lint è„šæœ¬ï¼ˆç§»é™¤ `--ext` å‚æ•°ï¼‰

#### å…¶ä»–é…ç½®æ–‡ä»¶

**`.gitignore`**ï¼š

- Git å¿½ç•¥æ–‡ä»¶é…ç½®
- é€šå¸¸å¿½ç•¥ `node_modules/`ã€`.yarn/cache/`ã€`dist/` ç­‰

**`tsconfig.json`**ï¼š

- TypeScript ç¼–è¯‘é…ç½®
- å®šä¹‰ç±»å‹æ£€æŸ¥è§„åˆ™å’Œç¼–è¯‘é€‰é¡¹

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
yarn install
```

### 2. å¼€å‘æ¨¡å¼è¿è¡Œ

```bash
yarn dev
```

è¿™å°†å¯åŠ¨ Electron åº”ç”¨ï¼Œå¹¶å¼€å¯çƒ­é‡è½½ã€‚

### 3. æ„å»ºåº”ç”¨

```bash
yarn build
```

### 4. ç±»å‹æ£€æŸ¥

```bash
yarn typecheck
```

---

## ğŸ’» å¼€å‘æŒ‡å—

### å¼€å‘æµç¨‹

1. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**

   ```bash
   yarn dev
   ```

2. **ä¿®æ”¹ä»£ç **
   - ä¿®æ”¹ä¸»è¿›ç¨‹ä»£ç ï¼š`src/main/`
   - ä¿®æ”¹æ¸²æŸ“è¿›ç¨‹ä»£ç ï¼š`src/renderer/src/`
   - ä¿®æ”¹é¢„åŠ è½½è„šæœ¬ï¼š`src/preload/`

3. **çƒ­é‡è½½**
   - æ¸²æŸ“è¿›ç¨‹æ”¯æŒçƒ­é‡è½½ï¼ˆHMRï¼‰
   - ä¸»è¿›ç¨‹ä¿®æ”¹åéœ€è¦é‡å¯åº”ç”¨

### ä»£ç è§„èŒƒ

#### TypeScript

- ä½¿ç”¨ä¸¥æ ¼æ¨¡å¼
- é¿å…ä½¿ç”¨ `any`ï¼Œä½¿ç”¨å…·ä½“ç±»å‹
- æ¥å£ä¼˜å…ˆäºç±»å‹åˆ«å

#### React ç»„ä»¶

- ä½¿ç”¨å‡½æ•°ç»„ä»¶å’Œ Hooks
- ç»„ä»¶æ–‡ä»¶ä½¿ç”¨ PascalCase
- Props ä½¿ç”¨ TypeScript æ¥å£å®šä¹‰

#### æ–‡ä»¶ç»„ç»‡

- æŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡æ–‡ä»¶
- æ¯ä¸ªæ¨¡å—åŒ…å«ï¼šç»„ä»¶ã€æœåŠ¡ã€ç±»å‹ã€å·¥å…·å‡½æ•°
- ä½¿ç”¨è·¯å¾„åˆ«åï¼ˆ`@renderer`ã€`@main`ï¼‰

### æ·»åŠ æ–°åŠŸèƒ½

#### 1. æ·»åŠ æ–°çš„ IPC é€šä¿¡

**ä¸»è¿›ç¨‹** (`src/main/ipc.ts`)ï¼š

```typescript
ipcMain.handle('new:action', async (_, data) => {
  // å¤„ç†é€»è¾‘
  return result
})
```

**é¢„åŠ è½½è„šæœ¬** (`src/preload/index.ts`)ï¼š

```typescript
newAction: (data: any) => ipcRenderer.invoke('new:action', data)
```

**æ¸²æŸ“è¿›ç¨‹**ï¼š

```typescript
const result = await window.api.newAction(data)
```

#### 2. æ·»åŠ æ–°çš„ Redux State

**åˆ›å»º Slice** (`src/renderer/src/store/newFeature.ts`)ï¼š

```typescript
import { createSlice } from '@reduxjs/toolkit'

const newFeatureSlice = createSlice({
  name: 'newFeature',
  initialState: {},
  reducers: {}
})

export default newFeatureSlice.reducer
```

**æ³¨å†Œåˆ° Store** (`src/renderer/src/store/index.ts`)ï¼š

```typescript
import newFeature from './newFeature'

const rootReducer = combineReducers({
  // ...
  newFeature
})
```

#### 3. æ·»åŠ æ–°çš„æ•°æ®åº“è¡¨

**å®šä¹‰è¡¨** (`src/renderer/src/databases/index.ts`)ï¼š

```typescript
export const db = new Dexie('ElectronHello') as Dexie & {
  // ...
  newTable: EntityTable<NewType, 'id'>
}

db.version(2).stores({
  // ...
  newTable: '&id, field1, field2'
})
```

---

## ğŸ“¦ æ„å»ºæ‰“åŒ…

### å¼€å‘æ„å»º

```bash
yarn build
```

### æ‰“åŒ…åº”ç”¨

#### Windows

```bash
# éœ€è¦å…ˆæ„å»º
yarn build

# ç„¶åæ‰“åŒ…ï¼ˆéœ€è¦ electron-builderï¼‰
npx electron-builder --win
```

#### macOS

```bash
npx electron-builder --mac
```

#### Linux

```bash
npx electron-builder --linux
```

### æ‰“åŒ…é…ç½®

æ‰“åŒ…é…ç½®åœ¨ `electron-builder.yml` ä¸­ï¼š

- **Windows**ï¼šNSIS å®‰è£…ç¨‹åº
- **macOS**ï¼šdmg å’Œ zip
- **Linux**ï¼šAppImageã€debã€rpm

#### electron-builder.yml é…ç½®æ–‡ä»¶è¯¦è§£

`electron-builder.yml` æ˜¯ **electron-builder** å·¥å…·çš„é…ç½®æ–‡ä»¶ï¼ˆä¸æ˜¯ electron-vite çš„ï¼‰ã€‚electron-builder è´Ÿè´£å°†æ„å»ºå¥½çš„åº”ç”¨æ‰“åŒ…æˆå®‰è£…åŒ…ï¼Œè€Œ electron-vite è´Ÿè´£å¼€å‘å’Œæ„å»ºä»£ç ã€‚

**å·¥å…·åˆ†å·¥ï¼š**
- **electron-vite**ï¼šå¼€å‘ä¸æ„å»ºå·¥å…·ï¼Œç¼–è¯‘ TypeScriptã€æ‰“åŒ…ä»£ç 
- **electron-builder**ï¼šæ‰“åŒ…å·¥å…·ï¼Œå°†æ„å»ºäº§ç‰©æ‰“åŒ…æˆå®‰è£…åŒ…ï¼ˆWindowsã€macOSã€Linuxï¼‰

**å·¥ä½œæµç¨‹ï¼š**
```
å¼€å‘é˜¶æ®µ â†’ electron-vite dev (å¼€å‘)
    â†“
æ„å»ºé˜¶æ®µ â†’ electron-vite build (ç¼–è¯‘ä»£ç åˆ° out ç›®å½•)
    â†“
æ‰“åŒ…é˜¶æ®µ â†’ electron-builder (è¯»å– electron-builder.ymlï¼Œæ‰“åŒ…æˆå®‰è£…åŒ…)
```

**é…ç½®æ–‡ä»¶é€è¡Œè¯´æ˜ï¼š**

##### åŸºç¡€åº”ç”¨ä¿¡æ¯ï¼ˆ1-3è¡Œï¼‰

**ç¬¬1è¡Œ** `appId: com.electron.hello`
- åº”ç”¨å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆåå‘åŸŸåæ ¼å¼ï¼‰ï¼Œç”¨äºç³»ç»Ÿæ³¨å†Œå’Œæ›´æ–°

**ç¬¬2è¡Œ** `productName: Electron Hello`
- äº§å“åç§°ï¼Œç”¨äºå®‰è£…åŒ…å’Œå¿«æ·æ–¹å¼

**ç¬¬3è¡Œ** `copyright: Copyright @ 2025`
- ç‰ˆæƒä¿¡æ¯

##### ç›®å½•é…ç½®ï¼ˆ4-6è¡Œï¼‰

**ç¬¬4è¡Œ** `directories:`
- ç›®å½•é…ç½®å—å¼€å§‹

**ç¬¬5è¡Œ** `buildResources: build`
- æ„å»ºèµ„æºç›®å½•ï¼ˆå›¾æ ‡ã€è„šæœ¬ç­‰ï¼‰

**ç¬¬6è¡Œ** `output: dist`
- è¾“å‡ºç›®å½•ï¼ˆæ‰“åŒ…äº§ç‰©ï¼‰

##### ASAR é…ç½®ï¼ˆ7è¡Œï¼‰

**ç¬¬7è¡Œ** `asar: true`
- å¯ç”¨ ASAR æ‰“åŒ…ï¼ˆå°†åº”ç”¨æ‰“åŒ…ä¸ºå•ä¸ªå½’æ¡£æ–‡ä»¶ï¼‰

##### æ–‡ä»¶åŒ…å«/æ’é™¤é…ç½®ï¼ˆ8-27è¡Œï¼‰

**ç¬¬8è¡Œ** `files:`
- æ–‡ä»¶åŒ…å«/æ’é™¤é…ç½®å—å¼€å§‹

**ç¬¬9è¡Œ** `- '!src/**'`
- æ’é™¤ src ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•

**ç¬¬10è¡Œ** `- '!src'`
- æ’é™¤ src ç›®å½•æœ¬èº«

**ç¬¬11-12è¡Œ** æ’é™¤ scripts ç›®å½•
- æ’é™¤è„šæœ¬ç›®å½•åŠå…¶å­ç›®å½•

**ç¬¬13è¡Œ** `- '!docs/**'`
- æ’é™¤ docs ç›®å½•

**ç¬¬14è¡Œ** `- '!**/*.ts'`
- æ’é™¤æ‰€æœ‰ TypeScript æºç æ–‡ä»¶

**ç¬¬15è¡Œ** `- '!**/*.tsx'`
- æ’é™¤æ‰€æœ‰ TSX æºç æ–‡ä»¶

**ç¬¬16è¡Œ** `- '!**/*.less'`
- æ’é™¤æ‰€æœ‰ Less æ ·å¼æºç æ–‡ä»¶

**ç¬¬17è¡Œ** `- '!**/*.scss'`
- æ’é™¤æ‰€æœ‰ SCSS æ ·å¼æºç æ–‡ä»¶

**ç¬¬18è¡Œ** `- '!**/*.sass'`
- æ’é™¤æ‰€æœ‰ SASS æ ·å¼æºç æ–‡ä»¶

**ç¬¬19è¡Œ** `- '!**/*.css.d.ts'`
- æ’é™¤ CSS ç±»å‹å®šä¹‰æ–‡ä»¶

**ç¬¬20è¡Œ** `- '!**/*.d.ts'`
- æ’é™¤æ‰€æœ‰ TypeScript ç±»å‹å®šä¹‰æ–‡ä»¶

**ç¬¬21è¡Œ** `- '!**/{test,tests,__tests__,coverage}/**'`
- æ’é™¤æµ‹è¯•ç›®å½•å’Œè¦†ç›–ç‡ç›®å½•

**ç¬¬22è¡Œ** `- '!**/*.{spec,test}.{js,jsx,ts,tsx}'`
- æ’é™¤æ‰€æœ‰æµ‹è¯•æ–‡ä»¶ï¼ˆspecã€test åç¼€ï¼‰

**ç¬¬23è¡Œ** `- '!**/*.map'`
- æ’é™¤æ‰€æœ‰ Source Map æ–‡ä»¶

**ç¬¬24è¡Œ** `- '!**/{LICENSE,LICENSE.txt,README.md,CHANGELOG.md}'`
- æ’é™¤è®¸å¯è¯å’Œæ–‡æ¡£æ–‡ä»¶

**ç¬¬25è¡Œ** `- '!**/*.md'`
- æ’é™¤æ‰€æœ‰ Markdown æ–‡ä»¶

**ç¬¬26è¡Œ** `- '!**/{.DS_Store,Thumbs.db}'`
- æ’é™¤ç³»ç»Ÿæ–‡ä»¶ï¼ˆmacOS å’Œ Windowsï¼‰

**ç¬¬27è¡Œ** `- '!**/.git/**'`
- æ’é™¤ Git ç‰ˆæœ¬æ§åˆ¶ç›®å½•

##### Windows å¹³å°é…ç½®ï¼ˆ28-33è¡Œï¼‰

**ç¬¬28è¡Œ** `win:`
- Windows å¹³å°é…ç½®å—å¼€å§‹

**ç¬¬29è¡Œ** `executableName: ElectronHello`
- Windows å¯æ‰§è¡Œæ–‡ä»¶å

**ç¬¬30è¡Œ** `artifactName: ${productName}-${version}-setup.${ext}`
- å®‰è£…åŒ…æ–‡ä»¶åæ¨¡æ¿ï¼ˆä½¿ç”¨å˜é‡ï¼šäº§å“å-ç‰ˆæœ¬å·-setup.æ‰©å±•åï¼‰

**ç¬¬31-32è¡Œ** `target:` / `- target: nsis`
- æ‰“åŒ…ç›®æ ‡ï¼šNSIS å®‰è£…ç¨‹åº

**ç¬¬33è¡Œ** `icon: build/icon.ico`
- Windows åº”ç”¨å›¾æ ‡è·¯å¾„

##### macOS å¹³å°é…ç½®ï¼ˆ34-44è¡Œï¼‰

**ç¬¬34è¡Œ** `mac:`
- macOS å¹³å°é…ç½®å—å¼€å§‹

**ç¬¬35è¡Œ** `artifactName: ${productName}-${version}-${arch}.${ext}`
- å®‰è£…åŒ…æ–‡ä»¶åæ¨¡æ¿ï¼ˆåŒ…å«æ¶æ„ä¿¡æ¯ï¼‰

**ç¬¬36-44è¡Œ** `target:`
- æ‰“åŒ…ç›®æ ‡é…ç½®
  - **ç¬¬37-40è¡Œ**ï¼šDMG æ ¼å¼ï¼Œæ”¯æŒ arm64 å’Œ x64 æ¶æ„
  - **ç¬¬41-44è¡Œ**ï¼šZIP æ ¼å¼ï¼Œæ”¯æŒ arm64 å’Œ x64 æ¶æ„

##### Linux å¹³å°é…ç½®ï¼ˆ45-57è¡Œï¼‰

**ç¬¬45è¡Œ** `linux:`
- Linux å¹³å°é…ç½®å—å¼€å§‹

**ç¬¬46è¡Œ** `artifactName: ${productName}-${version}-${arch}.${ext}`
- å®‰è£…åŒ…æ–‡ä»¶åæ¨¡æ¿ï¼ˆåŒ…å«æ¶æ„ä¿¡æ¯ï¼‰

**ç¬¬47-55è¡Œ** `target:`
- æ‰“åŒ…ç›®æ ‡é…ç½®
  - **ç¬¬48-51è¡Œ**ï¼šAppImage æ ¼å¼ï¼Œæ”¯æŒ arm64 å’Œ x64 æ¶æ„
  - **ç¬¬52-55è¡Œ**ï¼šdeb æ ¼å¼ï¼Œæ”¯æŒ arm64 å’Œ x64 æ¶æ„

**ç¬¬56è¡Œ** `icon: build/icon.png`
- Linux åº”ç”¨å›¾æ ‡è·¯å¾„

**æ€»ç»“ï¼š** è¯¥é…ç½®æ–‡ä»¶ç”¨äºå°† Electron Hello åº”ç”¨æ‰“åŒ…ä¸º Windowsï¼ˆNSISï¼‰ã€macOSï¼ˆDMG/ZIPï¼‰å’Œ Linuxï¼ˆAppImage/debï¼‰å®‰è£…åŒ…ï¼Œå¹¶æ’é™¤äº†æºç ã€æµ‹è¯•ã€æ–‡æ¡£ç­‰å¼€å‘æ–‡ä»¶ï¼Œä»…æ‰“åŒ…ç¼–è¯‘åçš„ç”Ÿäº§æ–‡ä»¶ã€‚

---

## ğŸ“š æŠ€æœ¯è¯¦è§£

### Electron æ ¸å¿ƒæ¦‚å¿µ

#### 1. ä¸»è¿›ç¨‹ï¼ˆMain Processï¼‰

ä¸»è¿›ç¨‹æ˜¯ Electron åº”ç”¨çš„å…¥å£ç‚¹ï¼Œè´Ÿè´£ï¼š

- åˆ›å»ºå’Œç®¡ç†åº”ç”¨çª—å£
- å¤„ç†ç³»ç»Ÿçº§æ“ä½œ
- ç®¡ç†åº”ç”¨ç”Ÿå‘½å‘¨æœŸ

**å…³é”®æ–‡ä»¶**ï¼š

- `src/main/index.ts`ï¼šåº”ç”¨å…¥å£
- `src/main/services/WindowService.ts`ï¼šçª—å£ç®¡ç†

#### 2. æ¸²æŸ“è¿›ç¨‹ï¼ˆRenderer Processï¼‰

æ¸²æŸ“è¿›ç¨‹è´Ÿè´£æ˜¾ç¤ºç”¨æˆ·ç•Œé¢ï¼š

- è¿è¡Œåœ¨ Chromium ç¯å¢ƒä¸­
- å¯ä»¥ä½¿ç”¨æ‰€æœ‰ Web API
- é€šè¿‡ IPC ä¸ä¸»è¿›ç¨‹é€šä¿¡

**å…³é”®æ–‡ä»¶**ï¼š

- `src/renderer/src/main.tsx`ï¼šReact å…¥å£
- `src/renderer/src/App.tsx`ï¼šæ ¹ç»„ä»¶

#### 3. é¢„åŠ è½½è„šæœ¬ï¼ˆPreload Scriptï¼‰

é¢„åŠ è½½è„šæœ¬åœ¨ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹ä¹‹é—´å»ºç«‹æ¡¥æ¢ï¼š

- åœ¨æ¸²æŸ“è¿›ç¨‹åŠ è½½å‰è¿è¡Œ
- å¯ä»¥è®¿é—® Node.js API
- é€šè¿‡ `contextBridge` å®‰å…¨æš´éœ² API

**å…³é”®æ–‡ä»¶**ï¼š

- `src/preload/index.ts`ï¼šPreload å…¥å£

### IPC é€šä¿¡

#### è¯·æ±‚-å“åº”æ¨¡å¼

```typescript
// ä¸»è¿›ç¨‹
ipcMain.handle('app:info', () => {
  return { version: app.getVersion() }
})

// æ¸²æŸ“è¿›ç¨‹
const info = await window.api.getAppInfo()
```

#### äº‹ä»¶ç›‘å¬æ¨¡å¼

```typescript
// ä¸»è¿›ç¨‹
mainWindow.webContents.send('theme-changed', theme)

// æ¸²æŸ“è¿›ç¨‹
window.api.onThemeChanged(theme => {
  console.log('Theme changed:', theme)
})
```

### æ•°æ®å­˜å‚¨

#### IndexedDBï¼ˆDexieï¼‰

##### ä»€ä¹ˆæ˜¯ IndexedDBï¼Ÿ

IndexedDB æ˜¯æµè§ˆå™¨æä¾›çš„å®¢æˆ·ç«¯ NoSQL æ•°æ®åº“ APIï¼Œç”¨äºåœ¨æµè§ˆå™¨ä¸­å­˜å‚¨å¤§é‡ç»“æ„åŒ–æ•°æ®ã€‚

**ä¸»è¦ç‰¹ç‚¹ï¼š**

- **å¤§å®¹é‡å­˜å‚¨**ï¼šé€šå¸¸å¯å­˜å‚¨æ•°ç™¾ MB åˆ°æ•° GB çš„æ•°æ®
- **å¼‚æ­¥æ“ä½œ**ï¼šåŸºäº Promise/å›è°ƒï¼Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹
- **é”®å€¼å¯¹å­˜å‚¨**ï¼šæ”¯æŒå¯¹è±¡å­˜å‚¨ï¼ˆObject Storeï¼‰
- **ç´¢å¼•æ”¯æŒ**ï¼šå¯ä»¥åˆ›å»ºç´¢å¼•ä»¥åŠ é€ŸæŸ¥è¯¢
- **äº‹åŠ¡æ”¯æŒ**ï¼šä¿è¯æ•°æ®ä¸€è‡´æ€§
- **æŒä¹…åŒ–**ï¼šæ•°æ®ä¿å­˜åœ¨æœ¬åœ°ï¼Œå…³é—­æµè§ˆå™¨åä»ç„¶å­˜åœ¨

##### ä»€ä¹ˆæ˜¯ Dexieï¼Ÿ

Dexie æ˜¯ IndexedDB çš„å°è£…åº“ï¼Œè®© IndexedDB çš„ä½¿ç”¨å˜å¾—ç®€å•æ˜“ç”¨ã€‚

**ä¸»è¦ä¼˜åŠ¿ï¼š**

- **æ›´ç®€æ´çš„ API**ï¼šç±»ä¼¼ ORM çš„è¯­æ³•ï¼Œä»£ç æ›´æ˜“è¯»
- **TypeScript æ”¯æŒ**ï¼šæä¾›å®Œæ•´çš„ç±»å‹å®šä¹‰
- **åŸç”Ÿ Promise æ”¯æŒ**ï¼šæ— éœ€å¤„ç†å›è°ƒï¼Œç›´æ¥ä½¿ç”¨ `await`
- **ç‰ˆæœ¬ç®¡ç†**ï¼šå†…ç½®æ•°æ®åº“ç‰ˆæœ¬å‡çº§æœºåˆ¶
- **å¼ºå¤§çš„æŸ¥è¯¢èƒ½åŠ›**ï¼šæä¾›é“¾å¼æŸ¥è¯¢ API
- **React é›†æˆ**ï¼š`dexie-react-hooks` æä¾› React Hooks

##### ä¸ºä»€ä¹ˆé€‰æ‹© Dexieï¼Ÿ

ç›¸æ¯”ç›´æ¥ä½¿ç”¨åŸç”Ÿ IndexedDB APIï¼ŒDexie æä¾›äº†æ›´ç®€æ´çš„ä»£ç ï¼š

**åŸç”Ÿ IndexedDBï¼ˆå›è°ƒæ–¹å¼ï¼‰ï¼š**

```javascript
// âŒ åŸç”Ÿ IndexedDB ä½¿ç”¨å›è°ƒï¼Œä»£ç åµŒå¥—æ·±
const request = indexedDB.open('MyDatabase', 1)

request.onsuccess = function (event) {
  const db = event.target.result
  const transaction = db.transaction(['books'], 'readwrite')
  const store = transaction.objectStore('books')

  const addRequest = store.add({ title: 'æ–°ä¹¦' })

  addRequest.onsuccess = function () {
    console.log('æ·»åŠ æˆåŠŸ')
    // å¦‚æœè¦ç»§ç»­æŸ¥è¯¢ï¼Œåˆè¦åµŒå¥—ä¸€å±‚
    const getRequest = store.get(1)
    getRequest.onsuccess = function () {
      console.log('æŸ¥è¯¢ç»“æœ:', getRequest.result)
      // è¿™å°±æ˜¯"å›è°ƒåœ°ç‹±"ï¼ˆCallback Hellï¼‰
    }
    getRequest.onerror = function () {
      console.error('æŸ¥è¯¢å¤±è´¥')
    }
  }

  addRequest.onerror = function () {
    console.error('æ·»åŠ å¤±è´¥')
  }
}

request.onerror = function () {
  console.error('æ‰“å¼€æ•°æ®åº“å¤±è´¥')
}
```

**Dexieï¼ˆPromise æ–¹å¼ï¼‰ï¼š**

```typescript
// âœ… Dexie ä½¿ç”¨ Promiseï¼Œä»£ç ç®€æ´æ¸…æ™°
import { db } from './databases'

// æ·»åŠ æ•°æ®
await db.books.add({ title: 'æ–°ä¹¦' })
console.log('æ·»åŠ æˆåŠŸ')

// æŸ¥è¯¢æ•°æ® - ä¸éœ€è¦åµŒå¥—ï¼
const book = await db.books.get(1)
console.log('æŸ¥è¯¢ç»“æœ:', book)

// æ›´æ–°æ•°æ® - ç»§ç»­ç”¨ awaitï¼Œä»£ç æ˜¯çº¿æ€§çš„ï¼
await db.books.update(1, { title: 'æ›´æ–°åçš„ä¹¦å' })
```

##### æ•°æ®åº“å®šä¹‰

åœ¨ `src/renderer/src/databases/index.ts` ä¸­å®šä¹‰æ•°æ®åº“ï¼š

```typescript
import { Dexie, type EntityTable } from 'dexie'
import type { Book } from '@renderer/types'

export const db = new Dexie('ElectronHello') as Dexie & {
  books: EntityTable<Book, 'id'>
  settings: EntityTable<{ id: string; value: any }, 'id'>
}

// å®šä¹‰è¡¨ç»“æ„
db.version(1).stores({
  books: '&id, title, author, isbn, price, stock, category, publishDate, createdAt, updatedAt',
  settings: '&id, value'
})
```

##### åŸºæœ¬æ“ä½œ

**æ·»åŠ æ•°æ®ï¼š**

```typescript
await db.books.add({
  id: 'book_1',
  title: 'JavaScript é«˜çº§ç¨‹åºè®¾è®¡',
  author: 'Matt Frisbie',
  isbn: '978-7-115-48789-5',
  price: 129,
  stock: 10,
  category: 'ç§‘æŠ€',
  publishDate: '2020-01-01',
  createdAt: Date.now(),
  updatedAt: Date.now()
})
```

**æŸ¥è¯¢æ•°æ®ï¼š**

```typescript
// æ ¹æ® ID æŸ¥è¯¢
const book = await db.books.get('book_1')

// æŸ¥è¯¢æ‰€æœ‰
const allBooks = await db.books.toArray()

// æ¡ä»¶æŸ¥è¯¢
const techBooks = await db.books.where('category').equals('ç§‘æŠ€').toArray()

// èŒƒå›´æŸ¥è¯¢
const expensiveBooks = await db.books.where('price').above(100).toArray()
```

**æ›´æ–°æ•°æ®ï¼š**

```typescript
await db.books.update('book_1', {
  price: 99,
  updatedAt: Date.now()
})
```

**åˆ é™¤æ•°æ®ï¼š**

```typescript
await db.books.delete('book_1')
```

##### é”™è¯¯å¤„ç†

ä½¿ç”¨ Promise/await æ—¶ï¼Œé€šè¿‡ `try-catch` ç»Ÿä¸€å¤„ç†é”™è¯¯ï¼š

```typescript
// åœ¨é¡¹ç›®ä¸­çš„å®é™…ä½¿ç”¨ç¤ºä¾‹
const saveBookToDB = async (book: Book) => {
  try {
    if (await db.books.get(book.id)) {
      await db.books.update(book.id, book)
    } else {
      await db.books.add(book)
    }
  } catch (error) {
    console.error('Save book to DB failed:', error)
    throw error // å¯ä»¥å‘ä¸ŠæŠ›å‡ºé”™è¯¯
  }
}

// å®Œæ•´çš„é”™è¯¯å¤„ç†ç¤ºä¾‹
const handleDelete = async (id: string) => {
  try {
    await db.books.delete(id)
    dispatch(deleteBook(id))
    message.success('åˆ é™¤æˆåŠŸ')
  } catch (error) {
    message.error('åˆ é™¤å¤±è´¥')
    console.error(error)
  } finally {
    // finally å—æ— è®ºæˆåŠŸæˆ–å¤±è´¥éƒ½ä¼šæ‰§è¡Œ
    setLoading(false)
  }
}
```

**å¸¸è§é”™è¯¯ç±»å‹å¤„ç†ï¼š**

```typescript
const addBook = async (book: Book) => {
  try {
    await db.books.add(book)
    message.success('æ·»åŠ æˆåŠŸ')
  } catch (error: any) {
    // Dexie ä¼šæŠ›å‡ºå…·ä½“çš„é”™è¯¯ç±»å‹
    switch (error.name) {
      case 'ConstraintError':
        // ä¸»é”®å†²çªï¼ˆID å·²å­˜åœ¨ï¼‰
        message.error('è¯¥å›¾ä¹¦IDå·²å­˜åœ¨ï¼Œè¯·ä½¿ç”¨ä¸åŒçš„ID')
        break
      case 'QuotaExceededError':
        // å­˜å‚¨ç©ºé—´ä¸è¶³
        message.error('å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œè¯·æ¸…ç†æ•°æ®')
        break
      case 'InvalidStateError':
        // æ•°æ®åº“çŠ¶æ€é”™è¯¯
        message.error('æ•°æ®åº“çŠ¶æ€å¼‚å¸¸ï¼Œè¯·åˆ·æ–°é¡µé¢')
        break
      default:
        message.error('æ·»åŠ å¤±è´¥: ' + error.message)
    }
    console.error('è¯¦ç»†é”™è¯¯:', error)
  }
}
```

**Promise vs å›è°ƒçš„é”™è¯¯å¤„ç†å¯¹æ¯”ï¼š**

å›è°ƒæ–¹å¼éœ€è¦åœ¨æ¯ä¸ª `onerror` ä¸­åˆ†åˆ«å¤„ç†é”™è¯¯ï¼Œè€Œ Promise æ–¹å¼å¯ä»¥åœ¨ä¸€ä¸ª `try-catch` ä¸­ç»Ÿä¸€å¤„ç†æ‰€æœ‰é”™è¯¯ï¼Œä»£ç æ›´ç®€æ´ã€æ›´æ˜“ç»´æŠ¤ã€‚

##### ç‰ˆæœ¬å‡çº§

å½“éœ€è¦ä¿®æ”¹æ•°æ®åº“ç»“æ„æ—¶ï¼Œä½¿ç”¨ç‰ˆæœ¬å‡çº§ï¼š

```typescript
// ç‰ˆæœ¬ 1
db.version(1).stores({
  books: '&id, title, author'
})

// ç‰ˆæœ¬ 2ï¼šæ·»åŠ æ–°å­—æ®µ
db.version(2)
  .stores({
    books: '&id, title, author, price, category' // æ·»åŠ äº† price å’Œ category
  })
  .upgrade(async tx => {
    // æ•°æ®è¿ç§»é€»è¾‘
    const books = await tx.table('books').toCollection().toArray()
    for (const book of books) {
      await tx.table('books').update(book.id, {
        price: 0, // ä¸ºæ–°å­—æ®µè®¾ç½®é»˜è®¤å€¼
        category: 'æœªåˆ†ç±»'
      })
    }
  })
```

##### åœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨

æœ¬é¡¹ç›®ä½¿ç”¨ Dexie å­˜å‚¨ä»¥ä¸‹æ•°æ®ï¼š

- **å›¾ä¹¦æ•°æ®**ï¼šå­˜å‚¨åœ¨ `books` è¡¨ä¸­
- **åº”ç”¨è®¾ç½®**ï¼šå­˜å‚¨åœ¨ `settings` è¡¨ä¸­

å®é™…ä½¿ç”¨ç¤ºä¾‹è¯·å‚è€ƒï¼š

- `src/renderer/src/pages/BookStorePage.tsx`ï¼šå›¾ä¹¦ç®¡ç†é¡µé¢çš„æ•°æ®åº“æ“ä½œ
- `src/renderer/src/pages/components/BackupModal.tsx`ï¼šå¤‡ä»½æ¢å¤åŠŸèƒ½ä¸­çš„æ•°æ®åº“æ“ä½œ

#### localStorageï¼ˆRedux Persistï¼‰

##### ä»€ä¹ˆæ˜¯ localStorageï¼Ÿ

localStorage æ˜¯æµè§ˆå™¨æä¾›çš„ Web Storage API ä¹‹ä¸€ï¼Œç”¨äºåœ¨æµè§ˆå™¨ä¸­å­˜å‚¨é”®å€¼å¯¹æ•°æ®ã€‚

**ä¸»è¦ç‰¹ç‚¹ï¼š**

- **åŒæ­¥æ“ä½œ**ï¼šæ“ä½œæ˜¯åŒæ­¥çš„ï¼Œä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼ˆä½†é€šå¸¸å¾ˆå¿«ï¼‰
- **å­˜å‚¨é™åˆ¶**ï¼šé€šå¸¸é™åˆ¶ä¸º 5-10 MBï¼ˆä¸åŒæµè§ˆå™¨ä¸åŒï¼‰
- **æŒä¹…åŒ–**ï¼šæ•°æ®ä¿å­˜åœ¨æœ¬åœ°ï¼Œå…³é—­æµè§ˆå™¨åä»ç„¶å­˜åœ¨
- **åŒæºç­–ç•¥**ï¼šåªèƒ½è®¿é—®åŒæºï¼ˆç›¸åŒåè®®ã€åŸŸåã€ç«¯å£ï¼‰çš„æ•°æ®
- **å­—ç¬¦ä¸²å­˜å‚¨**ï¼šåªèƒ½å­˜å‚¨å­—ç¬¦ä¸²ï¼Œå¯¹è±¡éœ€è¦åºåˆ—åŒ–ï¼ˆJSON.stringifyï¼‰
- **ç®€å•æ˜“ç”¨**ï¼šAPI éå¸¸ç®€å•ï¼Œåªæœ‰ `getItem`ã€`setItem`ã€`removeItem` ç­‰æ–¹æ³•

**åŸºæœ¬ä½¿ç”¨ï¼š**

```javascript
// å­˜å‚¨æ•°æ®
localStorage.setItem('username', 'å¼ ä¸‰')
localStorage.setItem('theme', 'dark')

// è¯»å–æ•°æ®
const username = localStorage.getItem('username') // 'å¼ ä¸‰'
const theme = localStorage.getItem('theme') // 'dark'

// åˆ é™¤æ•°æ®
localStorage.removeItem('username')

// æ¸…ç©ºæ‰€æœ‰æ•°æ®
localStorage.clear()

// å­˜å‚¨å¯¹è±¡ï¼ˆéœ€è¦åºåˆ—åŒ–ï¼‰
const user = { name: 'å¼ ä¸‰', age: 25 }
localStorage.setItem('user', JSON.stringify(user))
const userObj = JSON.parse(localStorage.getItem('user') || '{}')
```

##### ä»€ä¹ˆæ˜¯ Redux Persistï¼Ÿ

Redux Persist æ˜¯ä¸€ä¸ª Redux ä¸­é—´ä»¶ï¼Œç”¨äºè‡ªåŠ¨å°† Redux Store çš„çŠ¶æ€æŒä¹…åŒ–åˆ°å­˜å‚¨ä¸­ï¼ˆå¦‚ localStorageï¼‰ï¼Œå¹¶åœ¨åº”ç”¨é‡æ–°åŠ è½½æ—¶è‡ªåŠ¨æ¢å¤çŠ¶æ€ã€‚

**ä¸»è¦åŠŸèƒ½ï¼š**

- **è‡ªåŠ¨æŒä¹…åŒ–**ï¼šRedux Store çŠ¶æ€å˜åŒ–æ—¶è‡ªåŠ¨ä¿å­˜åˆ° localStorage
- **è‡ªåŠ¨æ¢å¤**ï¼šåº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨ä» localStorage æ¢å¤çŠ¶æ€
- **é€‰æ‹©æ€§æŒä¹…åŒ–**ï¼šå¯ä»¥é€‰æ‹©å“ªäº›çŠ¶æ€éœ€è¦æŒä¹…åŒ–ï¼Œå“ªäº›ä¸éœ€è¦
- **ç‰ˆæœ¬ç®¡ç†**ï¼šæ”¯æŒæ•°æ®ç‰ˆæœ¬è¿ç§»
- **å¤šç§å­˜å‚¨å¼•æ“**ï¼šæ”¯æŒ localStorageã€sessionStorageã€IndexedDB ç­‰

##### ä¸ºä»€ä¹ˆéœ€è¦ Redux Persistï¼Ÿ

**ä¸ä½¿ç”¨ Redux Persist çš„é—®é¢˜ï¼š**

```typescript
// âŒ æ²¡æœ‰æŒä¹…åŒ–ï¼Œæ¯æ¬¡åˆ·æ–°é¡µé¢çŠ¶æ€éƒ½ä¼šä¸¢å¤±
const store = configureStore({
  reducer: rootReducer
})

// ç”¨æˆ·è®¾ç½®äº†ä¸»é¢˜ä¸º 'dark'
dispatch(setTheme('dark'))

// åˆ·æ–°é¡µé¢åï¼Œä¸»é¢˜åˆå˜å›äº†é»˜è®¤å€¼ 'light'
// ç”¨æˆ·éœ€è¦é‡æ–°è®¾ç½®ï¼Œä½“éªŒå¾ˆå·®
```

**ä½¿ç”¨ Redux Persist çš„ä¼˜åŠ¿ï¼š**

```typescript
// âœ… ä½¿ç”¨ Redux Persistï¼ŒçŠ¶æ€è‡ªåŠ¨æŒä¹…åŒ–
const persistedReducer = persistReducer({ key: 'electron-hello', storage }, rootReducer)

// ç”¨æˆ·è®¾ç½®äº†ä¸»é¢˜ä¸º 'dark'
dispatch(setTheme('dark'))
// Redux Persist è‡ªåŠ¨ä¿å­˜åˆ° localStorage

// åˆ·æ–°é¡µé¢åï¼Œä¸»é¢˜è‡ªåŠ¨æ¢å¤ä¸º 'dark'
// ç”¨æˆ·ä½“éªŒæ›´å¥½
```

##### é…ç½® Redux Persist

åœ¨ `src/renderer/src/store/index.ts` ä¸­é…ç½®ï¼š

```typescript
import { persistReducer, persistStore } from 'redux-persist'
import storage from 'redux-persist/lib/storage' // ä½¿ç”¨ localStorage

const persistedReducer = persistReducer(
  {
    key: 'electron-hello', // localStorage ä¸­çš„ key
    storage, // å­˜å‚¨å¼•æ“ï¼ˆlocalStorageï¼‰
    version: 1, // æ•°æ®ç‰ˆæœ¬å·
    blacklist: [] // ä¸æŒä¹…åŒ–çš„çŠ¶æ€ï¼ˆç©ºæ•°ç»„è¡¨ç¤ºå…¨éƒ¨æŒä¹…åŒ–ï¼‰
    // whitelist: ['settings']     // åªæŒä¹…åŒ–æŒ‡å®šçš„çŠ¶æ€
  },
  rootReducer
)

const store = configureStore({
  reducer: persistedReducer,
  middleware: getDefaultMiddleware => {
    return getDefaultMiddleware({
      serializableCheck: {
        // å¿½ç•¥ Redux Persist çš„ action
        ignoredActions: [FLUSH, REHYDRATE, PAUSE, PERSIST, PURGE, REGISTER]
      }
    })
  }
})

// åˆ›å»º persistor
export const persistor = persistStore(store)
```

##### åœ¨ React ä¸­ä½¿ç”¨

åœ¨ `src/renderer/src/main.tsx` ä¸­ä½¿ç”¨ `PersistGate`ï¼š

```typescript
import { PersistGate } from 'redux-persist/integration/react'
import { persistor } from '@renderer/store'

ReactDOM.createRoot(document.getElementById('root')!).render(
  <Provider store={store}>
    <PersistGate loading={null} persistor={persistor}>
      {/* PersistGate ä¼šç­‰å¾…çŠ¶æ€æ¢å¤åå†æ¸²æŸ“å­ç»„ä»¶ */}
      <App />
    </PersistGate>
  </Provider>
)
```

**PersistGate çš„ä½œç”¨ï¼š**

- åœ¨åº”ç”¨å¯åŠ¨æ—¶ï¼Œç­‰å¾… Redux Persist ä» localStorage æ¢å¤çŠ¶æ€
- æ¢å¤å®Œæˆåæ‰æ¸²æŸ“å­ç»„ä»¶ï¼Œé¿å…çŠ¶æ€é—ªçƒ
- `loading={null}` è¡¨ç¤ºæ¢å¤æœŸé—´ä¸æ˜¾ç¤ºåŠ è½½æç¤º

##### å·¥ä½œæµç¨‹

**1. çŠ¶æ€å˜åŒ–æ—¶è‡ªåŠ¨ä¿å­˜ï¼š**

```typescript
// ç”¨æˆ·æ“ä½œè§¦å‘ action
dispatch(setTheme('dark'))

// Redux Persist è‡ªåŠ¨æ‹¦æˆª
// 1. Redux Store çŠ¶æ€æ›´æ–°
// 2. Redux Persist æ£€æµ‹åˆ°çŠ¶æ€å˜åŒ–
// 3. è‡ªåŠ¨åºåˆ—åŒ–çŠ¶æ€
// 4. ä¿å­˜åˆ° localStorageï¼ˆkey: 'electron-hello'ï¼‰
```

**2. åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨æ¢å¤ï¼š**

```typescript
// åº”ç”¨å¯åŠ¨
// 1. PersistGate ç­‰å¾…çŠ¶æ€æ¢å¤
// 2. Redux Persist ä» localStorage è¯»å–æ•°æ®
// 3. ååºåˆ—åŒ–æ•°æ®
// 4. æ¢å¤åˆ° Redux Store
// 5. è§¦å‘ REHYDRATE action
// 6. PersistGate æ¸²æŸ“å­ç»„ä»¶
```

##### é€‰æ‹©æ€§æŒä¹…åŒ–

**åªæŒä¹…åŒ–éƒ¨åˆ†çŠ¶æ€ï¼ˆwhitelistï¼‰ï¼š**

```typescript
const persistedReducer = persistReducer(
  {
    key: 'electron-hello',
    storage,
    whitelist: ['settings'] // åªæŒä¹…åŒ– settingsï¼Œä¸æŒä¹…åŒ– books
  },
  rootReducer
)
```

**æ’é™¤éƒ¨åˆ†çŠ¶æ€ï¼ˆblacklistï¼‰ï¼š**

```typescript
const persistedReducer = persistReducer(
  {
    key: 'electron-hello',
    storage,
    blacklist: ['books'] // ä¸æŒä¹…åŒ– booksï¼Œå…¶ä»–éƒ½æŒä¹…åŒ–
  },
  rootReducer
)
```

##### åœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨

æœ¬é¡¹ç›®ä½¿ç”¨ Redux Persist æŒä¹…åŒ–ä»¥ä¸‹çŠ¶æ€ï¼š

**1. è®¾ç½®çŠ¶æ€ï¼ˆsettingsï¼‰ï¼š**

```typescript
// src/renderer/src/store/settings.ts
const settingsSlice = createSlice({
  name: 'settings',
  initialState: {
    theme: 'light',
    language: 'zh-CN'
  },
  reducers: {
    setTheme: (state, action) => {
      state.theme = action.payload // è‡ªåŠ¨æŒä¹…åŒ–
    },
    setLanguage: (state, action) => {
      state.language = action.payload // è‡ªåŠ¨æŒä¹…åŒ–
    }
  }
})
```

**2. å›¾ä¹¦çŠ¶æ€ï¼ˆbooksï¼‰ï¼š**

```typescript
// å›¾ä¹¦åˆ—è¡¨çŠ¶æ€ä¹Ÿä¼šè‡ªåŠ¨æŒä¹…åŒ–
// ä½†æ³¨æ„ï¼šå¤§é‡æ•°æ®å»ºè®®ä½¿ç”¨ IndexedDBï¼Œè€Œä¸æ˜¯ localStorage
```

##### localStorage vs IndexedDB çš„é€‰æ‹©

**ä½¿ç”¨ localStorageï¼ˆRedux Persistï¼‰çš„åœºæ™¯ï¼š**

- âœ… åº”ç”¨çŠ¶æ€ï¼ˆä¸»é¢˜ã€è¯­è¨€ã€UI çŠ¶æ€ç­‰ï¼‰
- âœ… å°é‡æ•°æ®ï¼ˆ< 5MBï¼‰
- âœ… éœ€è¦å¿«é€Ÿè®¿é—®çš„æ•°æ®
- âœ… ç®€å•çš„é”®å€¼å¯¹æ•°æ®

**ä½¿ç”¨ IndexedDBï¼ˆDexieï¼‰çš„åœºæ™¯ï¼š**

- âœ… å¤§é‡æ•°æ®ï¼ˆ> 5MBï¼‰
- âœ… å¤æ‚æŸ¥è¯¢éœ€æ±‚
- âœ… ç»“æ„åŒ–æ•°æ®ï¼ˆå¦‚å›¾ä¹¦æ•°æ®ï¼‰
- âœ… éœ€è¦ç´¢å¼•å’Œäº‹åŠ¡

**æœ¬é¡¹ç›®çš„æ•°æ®å­˜å‚¨ç­–ç•¥ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ•°æ®åˆ†ç±»å­˜å‚¨ç­–ç•¥                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å›¾ä¹¦æ•°æ®     â†’ IndexedDB (å¤§å®¹é‡)       â”‚
â”‚ åº”ç”¨çŠ¶æ€     â†’ localStorage (å¿«é€Ÿ)      â”‚
â”‚ æ–‡ä»¶æ•°æ®     â†’ æ–‡ä»¶ç³»ç»Ÿ (åŸå§‹æ–‡ä»¶)       â”‚
â”‚ ç³»ç»Ÿé…ç½®     â†’ electron-store (ç»“æ„åŒ–)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### æ•°æ®å¤‡ä»½å’Œæ¢å¤

åœ¨å¤‡ä»½åŠŸèƒ½ä¸­ï¼ŒlocalStorage æ•°æ®ä¹Ÿä¼šè¢«å¤‡ä»½ï¼š

```typescript
// src/renderer/src/pages/components/BackupModal.tsx
const handleBackup = async () => {
  // è·å– localStorage æ•°æ®
  const localStorageData: Record<string, string> = {}
  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i)
    if (key) {
      localStorageData[key] = localStorage.getItem(key) || ''
    }
  }

  // åŒ…å«åœ¨å¤‡ä»½æ•°æ®ä¸­
  const backupData = {
    indexedDB: {
      /* ... */
    },
    localStorage: localStorageData // Redux Persist çš„æ•°æ®åœ¨è¿™é‡Œ
  }
}

// æ¢å¤æ—¶
const handleRestore = async (file: File) => {
  // æ¢å¤ localStorage
  if (backupData.localStorage) {
    for (const [key, value] of Object.entries(backupData.localStorage)) {
      localStorage.setItem(key, value as string)
    }
  }
}
```

##### å¸¸è§é—®é¢˜

**1. ä¸ºä»€ä¹ˆçŠ¶æ€æ²¡æœ‰æŒä¹…åŒ–ï¼Ÿ**

- æ£€æŸ¥æ˜¯å¦é…ç½®äº† `persistReducer`
- æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº† `PersistGate`
- æ£€æŸ¥ `blacklist` æ˜¯å¦æ’é™¤äº†è¯¥çŠ¶æ€

**2. å¦‚ä½•æ¸…é™¤æŒä¹…åŒ–çš„æ•°æ®ï¼Ÿ**

```typescript
import { persistor } from '@renderer/store'

// æ¸…é™¤æ‰€æœ‰æŒä¹…åŒ–çš„æ•°æ®
persistor.purge()

// æˆ–è€…ç›´æ¥æ¸…é™¤ localStorage
localStorage.removeItem('persist:electron-hello')
```

**3. å¦‚ä½•æ‰‹åŠ¨è§¦å‘æŒä¹…åŒ–ï¼Ÿ**

```typescript
// Redux Persist ä¼šè‡ªåŠ¨å¤„ç†ï¼Œä½†ä¹Ÿå¯ä»¥æ‰‹åŠ¨è§¦å‘
persistor.flush() // ç«‹å³ä¿å­˜åˆ° localStorage
```

##### å®é™…ä½¿ç”¨ç¤ºä¾‹

å‚è€ƒé¡¹ç›®ä¸­çš„å®é™…ä»£ç ï¼š

- `src/renderer/src/store/index.ts`ï¼šRedux Persist é…ç½®
- `src/renderer/src/main.tsx`ï¼šPersistGate ä½¿ç”¨
- `src/renderer/src/store/settings.ts`ï¼šæŒä¹…åŒ–çš„çŠ¶æ€ç¤ºä¾‹
- `src/renderer/src/pages/components/BackupModal.tsx`ï¼šå¤‡ä»½æ¢å¤ä¸­çš„ localStorage å¤„ç†

#### electron-store

ç”¨äºå­˜å‚¨ç³»ç»Ÿé…ç½®ï¼š

```typescript
const store = new Store<Config>({
  defaults: { theme: 'light' }
})

store.set('theme', 'dark')
const theme = store.get('theme')
```

### çŠ¶æ€ç®¡ç†

#### Redux Toolkit

ä½¿ç”¨ `createSlice` ç®€åŒ– Reducerï¼š

```typescript
const booksSlice = createSlice({
  name: 'books',
  initialState,
  reducers: {
    addBook: (state, action) => {
      state.books.push(action.payload)
    }
  }
})
```

#### Redux Persist

è‡ªåŠ¨æŒä¹…åŒ–çŠ¶æ€åˆ° localStorageï¼š

```typescript
const persistedReducer = persistReducer({ key: 'electron-hello', storage }, rootReducer)
```

### ä¸»é¢˜åˆ‡æ¢

#### å®ç°æ–¹å¼

1. **Redux Store**ï¼šå­˜å‚¨ä¸»é¢˜çŠ¶æ€
2. **ThemeProvider**ï¼šæä¾›ä¸»é¢˜ Context
3. **Ant Design**ï¼šæ ¹æ®ä¸»é¢˜åˆ‡æ¢ç®—æ³•
4. **ä¸»è¿›ç¨‹åŒæ­¥**ï¼šé€šè¿‡ IPC åŒæ­¥ä¸»é¢˜åˆ°ä¸»è¿›ç¨‹

#### ä½¿ç”¨ç¤ºä¾‹

```typescript
const { theme, toggleTheme } = useTheme()

<Button onClick={toggleTheme}>
  {theme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸'}
</Button>
```

### æ•°æ®å¤‡ä»½å’Œæ¢å¤

#### å¤‡ä»½æµç¨‹

1. æ”¶é›†æ‰€æœ‰æ•°æ®ï¼ˆIndexedDB + localStorageï¼‰
2. åºåˆ—åŒ–ä¸º JSON
3. å‹ç¼©ä¸º ZIP æ–‡ä»¶
4. ä¿å­˜åˆ°æ–‡ä»¶ç³»ç»Ÿ

#### æ¢å¤æµç¨‹

1. è¯»å– ZIP æ–‡ä»¶
2. è§£å‹å¹¶è§£æ JSON
3. æ¢å¤ IndexedDB æ•°æ®
4. æ¢å¤ localStorage æ•°æ®
5. é‡æ–°åŠ è½½åº”ç”¨

---

## ğŸ› å¸¸è§é—®é¢˜

### 1. Yarn äºŒè¿›åˆ¶æ–‡ä»¶ç¼ºå¤±

**é—®é¢˜**ï¼šè¿è¡Œ `yarn install` æ—¶æç¤º `Cannot find module '.yarn/releases/yarn-4.6.0.cjs'`

**è§£å†³æ–¹æ¡ˆ**ï¼š

**æ–¹æ³• 1ï¼šä» RunStudio ç›®å½•å¤åˆ¶ï¼ˆæ¨èï¼‰**

å¦‚æœåŒç›®å½•ä¸‹çš„ `RunStudio` é¡¹ç›®å·²ç»é…ç½®å¥½ Yarnï¼š

```powershell
# åˆ›å»ºç›®å½•
New-Item -ItemType Directory -Force -Path .yarn\releases

# å¤åˆ¶ Yarn äºŒè¿›åˆ¶æ–‡ä»¶
Copy-Item -Path "..\RunStudio\.yarn\releases\yarn-4.6.0.cjs" -Destination ".yarn\releases\yarn-4.6.0.cjs" -Force
```

**æ–¹æ³• 2ï¼šä½¿ç”¨ npm å®‰è£… Yarn**

```bash
npm install -g yarn
yarn install  # Yarn ä¼šè‡ªåŠ¨ä¸‹è½½æ­£ç¡®çš„ç‰ˆæœ¬
```

**æ–¹æ³• 3ï¼šä½¿ç”¨ corepack**

```bash
corepack enable
corepack prepare yarn@4.6.0 --activate
```

### 2. ä¾èµ–å®‰è£…å¤±è´¥

**é—®é¢˜ 1**ï¼š`yarn install` å¤±è´¥æˆ–ä¾èµ–ä¸å®Œæ•´

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# æ–¹æ³• 1ï¼šé‡æ–°å®‰è£…ä¾èµ–
yarn install

# æ–¹æ³• 2ï¼šæ¸…ç†ç¼“å­˜åé‡æ–°å®‰è£…
yarn cache clean
yarn install

# æ–¹æ³• 3ï¼šå®Œå…¨æ¸…ç†åé‡æ–°å®‰è£…
rm -rf node_modules yarn.lock  # Linux/macOS
# æˆ–
Remove-Item -Recurse -Force node_modules, yarn.lock  # Windows PowerShell

yarn install
```

**é—®é¢˜ 2**ï¼šåœ¨ conda ç¯å¢ƒä¸­ `yarn` æˆ– `node` å‘½ä»¤ä¸å¯ç”¨

**åŸå› **ï¼šconda ç¯å¢ƒå¯èƒ½æ²¡æœ‰æ­£ç¡®é…ç½® Node.js å’Œ Yarn çš„ PATH

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# æ–¹æ³• 1ï¼šæ¿€æ´»æ­£ç¡®çš„ conda ç¯å¢ƒ
conda activate cherry-studio

# æ–¹æ³• 2ï¼šæ£€æŸ¥ Node.js å’Œ npm æ˜¯å¦å¯ç”¨
node --version
npm --version

# å¦‚æœä¸å¯ç”¨ï¼Œå¯èƒ½éœ€è¦å®‰è£… Node.js åˆ° conda ç¯å¢ƒ
conda install nodejs npm -c conda-forge

# æ–¹æ³• 3ï¼šä½¿ç”¨å®Œæ•´è·¯å¾„è¿è¡Œï¼ˆå¦‚æœçŸ¥é“ Node.js è·¯å¾„ï¼‰
# ä¾‹å¦‚ï¼šC:\Users\YourName\anaconda3\envs\cherry-studio\Scripts\node.exe
```

**æ³¨æ„äº‹é¡¹**ï¼š

- æ£€æŸ¥ Node.js ç‰ˆæœ¬ï¼ˆ>= 18.0.0ï¼‰
- ç¡®ä¿ Yarn äºŒè¿›åˆ¶æ–‡ä»¶å·²æ­£ç¡®å®‰è£…ï¼ˆå‚è€ƒé—®é¢˜ 1ï¼‰
- å¦‚æœä¾èµ–å®‰è£…åä»ç„¶ç¼ºå°‘æŸäº›åŒ…ï¼ˆå¦‚ `vite`ï¼‰ï¼Œå‚è€ƒé—®é¢˜ 3 çš„è§£å†³æ–¹æ¡ˆ

### 3. å¼€å‘æ¨¡å¼æ— æ³•å¯åŠ¨

**é—®é¢˜ 1**ï¼š`yarn dev` æŠ¥é”™ `Cannot find package 'vite'`

**åŸå› **ï¼šä¾èµ–å®‰è£…ä¸å®Œæ•´ï¼Œ`vite` åŒ…æœªæ­£ç¡®å®‰è£…ï¼ˆ`electron-vite` éœ€è¦ `vite` ä½œä¸º peer dependencyï¼‰

**è§£å†³æ–¹æ¡ˆ**ï¼š

åœ¨ `package.json` çš„ `devDependencies` ä¸­æ·»åŠ  `vite`ï¼š

```json
"devDependencies": {
  ...
  "vite": "^5.0.12"
}
```

ç„¶åé‡æ–°å®‰è£…ä¾èµ–ï¼š

```bash
yarn install
```

**é—®é¢˜ 2**ï¼š`yarn dev` æŠ¥é”™ `Cannot find module 'javascript-obfuscator'`

**åŸå› **ï¼š`rollup-plugin-obfuscator` éœ€è¦ `javascript-obfuscator` ä½œä¸º peer dependency

**è§£å†³æ–¹æ¡ˆ**ï¼š

åœ¨ `package.json` çš„ `devDependencies` ä¸­æ·»åŠ  `javascript-obfuscator`ï¼š

```json
"devDependencies": {
  ...
  "javascript-obfuscator": "^4.1.1"
}
```

ç„¶åé‡æ–°å®‰è£…ä¾èµ–ï¼š

```bash
yarn install
```

**é—®é¢˜ 3**ï¼š`yarn dev` æŠ¥é”™å…¶ä»–é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š

- æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
- æ£€æŸ¥ `electron-vite` é…ç½®
- æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
- ç¡®ä¿æ‰€æœ‰ä¾èµ–å·²æ­£ç¡®å®‰è£…ï¼ˆå‚è€ƒé—®é¢˜ 1 å’Œé—®é¢˜ 2ï¼‰

### 4. Peer Dependency è­¦å‘Š

**é—®é¢˜**ï¼š`yarn install` åå‡ºç° peer dependency è­¦å‘Š

**å¸¸è§è­¦å‘Šç¤ºä¾‹**ï¼š

```
â¤ YN0002: â”‚ electron-hello@workspace:. doesn't provide vite (pf1fab), requested by @vitejs/plugin-react
â¤ YN0002: â”‚ electron-hello@workspace:. doesn't provide rollup (p7c804), requested by rollup-plugin-obfuscator
â¤ YN0002: â”‚ electron-hello@workspace:. doesn't provide javascript-obfuscator (p383ec), requested by rollup-plugin-obfuscator
â¤ YN0086: â”‚ Some peer dependencies are incorrectly met by your project
```

**åŸå› åˆ†æ**ï¼š

Yarn 4 é»˜è®¤ä¸ä¼šè‡ªåŠ¨å®‰è£… peer dependenciesï¼Œéœ€è¦æ‰‹åŠ¨åœ¨ `package.json` ä¸­æ˜¾å¼å£°æ˜ã€‚è¿™äº›è­¦å‘Šè¡¨ç¤ºæŸäº›æ’ä»¶éœ€è¦ç‰¹å®šçš„ä¾èµ–åŒ…ï¼Œä½†é¡¹ç›®ä¸­æ²¡æœ‰å®‰è£…ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

#### å¿…é¡»å®‰è£…çš„ä¾èµ–ï¼ˆå½±å“åŠŸèƒ½ï¼‰

ä»¥ä¸‹ä¾èµ–æ˜¯å¿…éœ€çš„ï¼Œå¿…é¡»æ·»åŠ åˆ° `package.json` çš„ `devDependencies` ä¸­ï¼š

```json
{
  "devDependencies": {
    "vite": "^5.0.12",                    // electron-vite éœ€è¦
    "rollup": "^4.0.0",                   // rollup-plugin-obfuscator éœ€è¦
    "javascript-obfuscator": "^4.1.1"     // rollup-plugin-obfuscator éœ€è¦
  }
}
```

#### å¯é€‰ä¾èµ–ï¼ˆä¸å½±å“è¿è¡Œï¼‰

ä»¥ä¸‹ä¾èµ–æ˜¯å¯é€‰çš„ï¼Œåªæœ‰åœ¨ç‰¹å®šåœºæ™¯ä¸‹æ‰éœ€è¦ï¼š

- `@babel/core`ï¼šå¦‚æœ `babel-plugin-styled-components` å‡ºç°é—®é¢˜ï¼Œå¯ä»¥æ·»åŠ 
- `electron-builder-squirrel-windows`ï¼šä»…åœ¨ Windows å¹³å°æ‰“åŒ…æ—¶éœ€è¦
- `@types/xxx`ï¼šTypeScript ç±»å‹å®šä¹‰ï¼ˆå¯é€‰ï¼‰
- `less`ã€`stylus`ã€`terser` ç­‰ï¼šå¯é€‰æ„å»ºå·¥å…·

#### æŸ¥çœ‹è¯¦ç»†è­¦å‘Šä¿¡æ¯

å¦‚æœéœ€è¦æŸ¥çœ‹è¯¦ç»†çš„ peer dependency è­¦å‘Šä¿¡æ¯ï¼š

```bash
# æŸ¥çœ‹æ‰€æœ‰ peer dependency è­¦å‘Š
yarn explain peer-requirements

# æŸ¥çœ‹ç‰¹å®šè­¦å‘Šçš„è¯¦ç»†ä¿¡æ¯ï¼ˆä½¿ç”¨è­¦å‘Šä¸­çš„ hash ç ï¼‰
yarn explain peer-requirements p7c804
```

#### è­¦å‘Šä¸¥é‡æ€§åˆ¤æ–­

- **âœ˜ æ ‡è®°**ï¼šè¡¨ç¤ºæœªæ»¡è¶³çš„ peer dependencyï¼Œå¯èƒ½å½±å“åŠŸèƒ½ï¼Œå»ºè®®ä¿®å¤
- **âœ“ æ ‡è®°ä½†æ˜¾ç¤º "doesn't provide"**ï¼šé€šå¸¸æ˜¯å¯é€‰çš„ peer dependencyï¼Œä¸å½±å“è¿è¡Œ

#### å¸¸è§çš„ âœ˜ æ ‡è®°é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

è¿è¡Œ `yarn explain peer-requirements` åï¼Œå¯èƒ½ä¼šçœ‹åˆ°ä¸€äº› âœ˜ æ ‡è®°çš„é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯å¸¸è§é—®é¢˜åŠå¤„ç†æ–¹å¼ï¼š

**1. `babel-plugin-styled-components` ç¼ºå°‘ `@babel/core`**

```
p25a32 â†’ âœ˜ babel-plugin-styled-components@npm:2.1.4 doesn't provide @babel/core to @babel/plugin-syntax-jsx@npm:7.27.1
```

**å½±å“**ï¼šå¦‚æœä½¿ç”¨ `styled-components` ä¸”é‡åˆ° Babel è½¬æ¢é—®é¢˜ï¼Œå¯èƒ½éœ€è¦æ·»åŠ ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼ˆä»…åœ¨é‡åˆ°é—®é¢˜æ—¶æ·»åŠ ï¼‰ï¼š

```json
{
  "devDependencies": {
    "@babel/core": "^7.28.5"
  }
}
```

**æ³¨æ„**ï¼šé€šå¸¸ `@vitejs/plugin-react` ä¼šé—´æ¥æä¾› `@babel/core`ï¼Œæ‰€ä»¥å¤§å¤šæ•°æƒ…å†µä¸‹ä¸éœ€è¦æ‰‹åŠ¨æ·»åŠ ã€‚

**2. `electron-builder` ç›¸å…³è­¦å‘Š**

```
p0281c â†’ âœ˜ dmg-builder@npm:24.13.2 doesn't provide electron-builder-squirrel-windows
p9d02f â†’ âœ˜ electron-builder@npm:24.13.2 doesn't provide electron-builder-squirrel-windows
p7177c â†’ âœ˜ electron-builder-squirrel-windows@npm:24.13.3 doesn't provide dmg-builder
```

**å½±å“**ï¼šä»…åœ¨ Windows å¹³å°æ‰“åŒ…æ—¶éœ€è¦ï¼Œä¸å½±å“å¼€å‘ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼ˆä»…åœ¨ Windows æ‰“åŒ…æ—¶æ·»åŠ ï¼‰ï¼š

```json
{
  "devDependencies": {
    "electron-builder-squirrel-windows": "^24.13.2"
  }
}
```

**3. `@inversifyjs/core` ç¼ºå°‘ `reflect-metadata`**

```
p0dcb3 â†’ âœ˜ @inversifyjs/core@npm:1.3.4 doesn't provide reflect-metadata
```

**å½±å“**ï¼šé¡¹ç›®æœªä½¿ç”¨ inversifyjsï¼Œå¯ä»¥å®Œå…¨å¿½ç•¥ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šæ— éœ€å¤„ç†ï¼Œè¿™æ˜¯å…¶ä»–ä¾èµ–çš„é—´æ¥ä¾èµ–é—®é¢˜ã€‚

**æ³¨æ„äº‹é¡¹**ï¼š

- å¤§éƒ¨åˆ† `YN0086` è­¦å‘Šéƒ½æ˜¯å¯é€‰çš„ï¼Œä¸å½±å“é¡¹ç›®è¿è¡Œ
- å¦‚æœé¡¹ç›®èƒ½æ­£å¸¸è¿è¡Œï¼ˆ`yarn dev` æˆåŠŸï¼‰ï¼Œå¯ä»¥æš‚æ—¶å¿½ç•¥è¿™äº›è­¦å‘Š
- åªæœ‰åœ¨é‡åˆ°è¿è¡Œæ—¶é”™è¯¯æ—¶ï¼Œæ‰éœ€è¦æ·»åŠ å¯¹åº”çš„ä¾èµ–
- `babel-plugin-styled-components` çš„ `@babel/core` è­¦å‘Šé€šå¸¸å¯ä»¥å¿½ç•¥ï¼Œå› ä¸º `@vitejs/plugin-react` ä¼šé—´æ¥æä¾›
- `electron-builder` ç›¸å…³çš„è­¦å‘Šåªåœ¨æ‰“åŒ…æ—¶æ‰æœ‰å½±å“ï¼Œå¼€å‘é˜¶æ®µå¯ä»¥å¿½ç•¥

### 5. æ„å»ºå¤±è´¥

**é—®é¢˜**ï¼š`yarn build` å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š

- æ£€æŸ¥ TypeScript ç±»å‹é”™è¯¯ï¼š`yarn typecheck`
- æ£€æŸ¥ ESLint é”™è¯¯ï¼š`yarn lint`
- æŸ¥çœ‹æ„å»ºæ—¥å¿—

### 6. æ‰“åŒ…ä½“ç§¯è¿‡å¤§

**é—®é¢˜**ï¼šæ‰“åŒ…åçš„åº”ç”¨ä½“ç§¯å¾ˆå¤§

**è§£å†³æ–¹æ¡ˆ**ï¼š

- è¿™æ˜¯æ­£å¸¸çš„ï¼ŒElectron éœ€è¦æ‰“åŒ… Chromium å’Œ Node.js
- å¯ä»¥ä½¿ç”¨ `electron-builder` çš„å‹ç¼©é€‰é¡¹
- æ’é™¤ä¸å¿…è¦çš„ä¾èµ–

---

## ğŸ“ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

---

## ğŸ™ è‡´è°¢

æœ¬é¡¹ç›®å‚è€ƒäº† RunStudio é¡¹ç›®çš„æ¶æ„è®¾è®¡å’ŒæŠ€æœ¯æ ˆï¼Œæ„Ÿè°¢ RunStudio å›¢é˜Ÿã€‚

---

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æäº¤ Issue æˆ– Pull Requestã€‚

---

**Happy Coding! ğŸš€**
